
<!DOCTYPE html>

<html lang="pt-BR">
<head>
  <link rel="manifest" href="manifest.json">
<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
</script>

<style>
/* ESTILO REFORMULADO DO PAINEL DE PERSONALIZAÃ‡ÃƒO */
#painel-personalizacao-embutido {
  background: #ffffff;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  font-size: 0.95rem;
}

#painel-personalizacao-embutido h1 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: #2f5d3f;
}

#painel-personalizacao-embutido .tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 1rem;
}

#painel-personalizacao-embutido .tab {
  background-color: #e9ecef;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  color: #2f5d3f;
  transition: background-color 0.2s;
}

#painel-personalizacao-embutido .tab.active {
  background-color: #2f5d3f;
  color: white;
}

#painel-personalizacao-embutido .section {
  border-top: 1px solid #dee2e6;
  padding-top: 1rem;
  margin-top: 1rem;
}

#painel-personalizacao-embutido label {
  font-weight: 600;
  display: block;
  margin-top: 1rem;
  margin-bottom: 0.5rem;
}

#painel-personalizacao-embutido input[type="text"],
#painel-personalizacao-embutido select {
  width: 100%;
  padding: 6px 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 0.9rem;
}

#painel-personalizacao-embutido button {
  margin-top: 0.5rem;
  background-color: #2f5d3f;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: background-color 0.2s;
}

#painel-personalizacao-embutido button:hover {
  background-color: #3d7a4f;
}

#painel-personalizacao-embutido select[multiple] {
  height: 100px;
}
</style>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>CRM RCF - Mobile</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
<script crossorigin="anonymous" src="https://kit.fontawesome.com/a2e0e6ad65.js">
function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}


function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<style>
    body {
      background: #f8f9fa;
    }
    header {
      background-color: #2f5d3f;
      color: white;
      padding: 0.75rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 {
  font-weight: bold;
      font-size: 1.25rem;
      margin: 0;
    }
    nav {
      display: flex;
      overflow-x: auto;
      background-color: #2f5d3f;
    }
    nav a {
  font-weight: bold;
      flex: 1;
      padding: 10px;
      text-align: center;
      color: white;
      text-decoration: none;
      font-size: 0.9rem;
      border-right: 1px solid rgba(255,255,255,0.1);
    }
    nav a:last-child {
      border-right: none;
    }
    nav a:hover, nav a.active {
      background-color: #3d7a4f;
    }
    .form-label {
      font-weight: 500;
    }
  
.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 5px;
  font-size: 0.75rem;
  text-align: center;
}
.calendar-day {
  padding: 8px 0;
  background: #e9ecef;
  border-radius: 5px;
}
.agendado {
  background-color: #198754;
  color: white;
  font-weight: bold;
}

.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 5px;
  font-size: 0.75rem;
  text-align: center;
}
.calendar-day {
  padding: 8px 0;
  background: #e9ecef;
  border-radius: 5px;
}
.cal-verde { background-color: #198754; color: white; font-weight: bold; }
.cal-azul { background-color: #0d6efd; color: white; font-weight: bold; }
.cal-roxo { background-color: #6f42c1; color: white; font-weight: bold; }
.cal-laranja { background-color: #fd7e14; color: white; font-weight: bold; }

.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 5px;
  font-size: 0.75rem;
  text-align: center;
}
.calendar-day {
  padding: 0;
  background: #e9ecef;
  border-radius: 5px;
  min-height: 40px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}
.calendar-day span {
  font-weight: bold;
}
.barra-cor {
  height: 5px;
  width: 100%;
}
.cal-verde { background-color: #198754; }
.cal-azul { background-color: #0d6efd; }
.cal-roxo { background-color: #6f42c1; }
.cal-laranja { background-color: #fd7e14; }

.legenda {
  font-size: 0.7rem;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
  margin-bottom: 15px;
}
.legenda-item {
  display: flex;
  align-items: center;
  gap: 5px;
}
.legenda-bolinha {
  width: 12px;
  height: 12px;
  border-radius: 50%;
}
.cal-controles {
  font-size: 0.75rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 5px;
}
#eventosDoDia {
  font-size: 0.75rem;
  background: #f8f9fa;
  padding: 10px;
  border-radius: 5px;
  display: none;
}
    </style>

<script>
// Remover aba "teste" do armazenamento local, se existir
(function() {
  let abas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  abas = abas.filter(a => a.toLowerCase() !== "teste");
  localStorage.setItem("abasPersonalizadas", JSON.stringify(abas));
})();
</script>

</head>
<body>
<header>
<span class="text-white small">Mobile</span>
</header>
<!-- Primeira linha de navegaÃ§Ã£o -->
<nav>
<a class="navbtn active" href="#" onclick="mostrarTela('tela-inicio', this)"><i class="fas fa-home"></i><br/>InÃ­cio</a>
<a class="navbtn" href="#" onclick="mostrarTela('tela-clientes', this)"><i class="fas fa-user"></i><br/>Clientes</a>
<a class="navbtn" href="#" onclick="mostrarTela('tela-agenda', this)"><i class="fas fa-calendar-alt"></i><br/>Agenda</a>
<a class="navbtn" href="#" onclick="mostrarTela('tela-albuns', this)"><i class="fas fa-book-open"></i><br/>Ãlbuns</a>
</nav>
<!-- Segunda linha de navegaÃ§Ã£o -->
<nav style="border-top: 1px solid rgba(255,255,255,0.1);">
<a class="navbtn" href="#" onclick="mostrarTela('tela-financeiro', this)"><i class="fas fa-dollar-sign"></i><br/>Financeiro</a>
<a class="navbtn" href="#" onclick="mostrarTela('tela-ferramentas', this)"><i class="fas fa-tools"></i><br/>Ferramentas</a>
<a class="navbtn" href="#" onclick="mostrarTela('tela-cashback', this)"><i class="fas fa-gift"></i><br/>Cashback</a>
<a class="navbtn" href="#" onclick="mostrarTela('tela-extra1', this)"><i class="fas fa-envelope"></i><br/>Mensagens</a>
</nav>
<main class="container py-4">
<div id="tela-inicio">
<h5 class="mb-3">ğŸ“… PrÃ³ximos Agendamentos</h5>
<div class="cal-controles">
<button class="btn btn-sm btn-outline-secondary" onclick="mudarMes(-1)">â—€ MÃªs anterior</button>
<span id="mesAtualLabel"></span>
<button class="btn btn-sm btn-outline-secondary" onclick="mudarMes(1)">PrÃ³ximo mÃªs â–¶</button>
</div>
<div id="eventosDoDia"></div>
<div class="legenda">
<div class="legenda-item"><div class="legenda-bolinha cal-verde"></div> Infantil / FamÃ­lia</div>
<div class="legenda-item"><div class="legenda-bolinha cal-azul"></div> AniversÃ¡rio</div>
<div class="legenda-item"><div class="legenda-bolinha cal-roxo"></div> Gestante</div>
<div class="legenda-item"><div class="legenda-bolinha cal-laranja"></div> Smash</div>
</div>
<div class="text-end">
<button class="btn btn-sm btn-outline-dark" onclick="exportarAgenda()">â¬‡ï¸ Exportar Agenda</button>
</div>
<div class="mb-4" id="calendarioAgendamentos"></div>
<div class="text-end mb-2">
<div class="d-inline-flex align-items-center gap-2">
<input class="form-control form-control-sm" id="idParaExcluir" placeholder="ID" style="max-width: 80px; font-size: 0.75rem;" type="number"/>
<button class="btn btn-sm btn-outline-danger" onclick="excluirAgendamentoPorID()" style="font-size: 0.75rem;">
      ğŸ—‘ï¸ Excluir
    </button>
</div>
</div>
<div class="text-end mb-2">
<button class="btn btn-sm btn-outline-secondary" onclick="limparAgendamentosIndefinidos()" style="font-size: 0.75rem;">
    ğŸ§¹ Limpar invÃ¡lidos
  </button>
</div>
<div class="text-end mb-2">
<button class="btn btn-sm btn-outline-secondary" id="botaoToggleAgendamentos" onclick="toggleAgendamentos()" style="font-size: 0.75rem;">
    ğŸ‘ï¸ Ocultar Agendamentos
  </button>
</div>
<div class="mb-3"></div><ul class="list-group small mb-4" id="listaProximosAgendamentos">
<li class="list-group-item">Nenhum agendamento futuro.</li>
</ul>
<!-- Inserir este bloco no final da <div id="tela-inicio"> -->
<div class="mt-4 small">
<div class="d-flex flex-wrap gap-2 align-items-end mt-4">
<div>
<button class="btn btn-outline-primary" onclick="document.getElementById('buscaNomeBox').classList.toggle('d-none')">
      ğŸ” Buscar por Nome
    </button>
</div>
<div>
</div>
</div>
<div class="d-none mt-3" id="buscaNomeBox" style="max-width: 500px;">
<input class="form-control mb-2" oninput="buscarAgendamentosPorNome(this.value)" placeholder="Digite o nome do cliente..." type="text"/>
<ul class="list-group" id="resultadosPorNome"></ul>
</div>
</div>
<script>
function buscarAgendamentosPorIDCliente() {
  const id = document.getElementById('buscaAgendamentosPorCliente').value.trim();
  if (!id) return;

  const hoje = new Date();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const cliente = clientes.find(c => c.id.toString() === id);

  const filtrados = agendamentos.filter(a => a.idCliente.toString() === id);
  const futuros = filtrados.filter(a => new Date(a.data + 'T' + a.hora) >= hoje);
  const passados = filtrados.filter(a => new Date(a.data + 'T' + a.hora) < hoje);

  const listaFuturos = document.getElementById('listaFuturosCliente');
  const listaPassados = document.getElementById('listaPassadosCliente');

  listaFuturos.innerHTML = futuros.length ? '' : '<li class="list-group-item">Nenhum futuro.</li>';
  listaPassados.innerHTML = passados.length ? '' : '<li class="list-group-item">Nenhum passado.</li>';

  const gerarTexto = (ag) => `ID: ${ag.id} | ${ag.data} - ${ag.tipo} - ${ag.pacote}`;

  futuros.forEach(a => {
    const li = document.createElement('li');
    li.className = 'list-group-item d-flex justify-content-between align-items-center';
    li.innerHTML = `<span>${gerarTexto(a)}</span><button class='btn btn-sm btn-outline-primary' onclick='gerarTextoWhatsAppPorIDDireto(${a.id})'>ğŸ“‹ Copiar</button>`;
    listaFuturos.appendChild(li);
  });

  passados.forEach(a => {
    const li = document.createElement('li');
    li.className = 'list-group-item d-flex justify-content-between align-items-center';
    li.innerHTML = `<span>${gerarTexto(a)}</span><button class='btn btn-sm btn-outline-primary' onclick='gerarTextoWhatsAppPorIDDireto(${a.id})'>ğŸ“‹ Copiar</button>`;
    listaPassados.appendChild(li);
  });

  document.getElementById('resultadosAgendamentosCliente').classList.remove('d-none');
}

function gerarTextoWhatsAppPorIDDireto(id) {
  document.getElementById('idAgendamentoTexto').value = id;
  gerarTextoWhatsAppPorID();
  copiarTextoWhatsApp();
  alert('Texto copiado com sucesso!');
}
</script>
</div>
<div id="tela-clientes" style="display:none;">
<h5 class="mb-3 d-flex justify-content-between align-items-center">
  ğŸ‘¤ Cadastro de Cliente
  <details class="ms-2" style="flex: 1; text-align: right;">
<summary style="cursor:pointer; font-size:0.8rem; color:#2f5d3f;">ğŸ“‹ Importar via texto</summary>
<textarea class="form-control form-control-sm mt-2" id="campoTextoImportacao" placeholder="Cole aqui o texto do cliente enviado por WhatsApp" rows="4"></textarea>
<button class="btn btn-outline-success btn-sm mt-2" onclick="importarClientePorTexto()">Importar</button>
</details>
</h5>
<div class="mb-3 d-flex align-items-end"><div class="me-2" style="flex: 1;"><label class="form-label">ID do Cliente</label><input class="form-control" id="buscarIdCliente" placeholder="Ex: 1" type="text"/></div><button class="btn btn-outline-primary" onclick="buscarClientePorID()">ğŸ” Buscar</button></div>
<div class="mb-3">
<label class="form-label">ğŸ” Buscar Cliente por Nome</label>
<input class="form-control" id="buscarNomeCliente" list="sugestoesClientes" onchange="preencherClientePorNome(this.value)" oninput="sugerirClientesPorNome(this.value)" placeholder="Digite o nome..." type="text"/>
<datalist id="sugestoesClientes"></datalist>
</div>
<div class="mb-3">
<label class="form-label">Nome do Cliente</label>
<input class="form-control" id="nomeCliente" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">Instagram</label>
<input class="form-control" id="instagramCliente" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">Nome do Filho(a)</label>
<input class="form-control" id="filhoCliente" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">Idade</label>
<input class="form-control" id="idadeCliente" type="number"/>
</div>
<div class="mb-3">
<label class="form-label">Postagem Autorizada?</label>
<select class="form-select" id="postagemCliente">
<option value="Sim">Sim</option>
<option value="NÃ£o">NÃ£o</option>
</select>
</div><div class="mb-3"><label class="form-label">Cashback acumulado</label><input class="form-control" disabled="" id="cashbackCliente" type="text" value="R$0,00"/></div>
<div class="d-grid mb-4">
<button class="btn btn-primary" onclick="salvarCliente()">Salvar Cliente</button>
<div class="d-grid mb-2">
</div>
<div class="d-grid mb-2">
</div>
</div>
<h6>ğŸ“‹ Clientes Cadastrados</h6>
<button class="btn btn-sm btn-outline-secondary mb-2" onclick="document.getElementById('listaClientes').classList.toggle('d-none')">ğŸ‘ï¸ Ocultar/Mostrar Clientes</button>
<div class="d-flex flex-wrap gap-2 mb-3">
<button onclick="ordenarClientesPorNome()" style="background-color: #4caf50; border: none; color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.85rem;">ğŸ”¤ Ordenar por Nome</button>
<button onclick="ordenarClientesPorID()" style="background-color: #2196f3; border: none; color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.85rem;">ğŸ”¢ Ordenar por ID</button>
</div>
<ul class="list-group small" id="listaClientes"></ul>
</div>
<div id="tela-agenda" style="display:none;">
<h5 class="mb-3">ğŸ—“ï¸ Agendar</h5>
<div class="mb-3">
<label class="form-label">ID do Cliente</label>
<input class="form-control" id="idCliente" type="text"/>
</div>
<div class="row g-2 mb-3">
<div class="col">
<label class="form-label">Data</label>
<input class="form-control" id="dataAgenda" type="date"/>
</div>
<div class="col">
<label class="form-label">InÃ­cio</label>
<input class="form-control" id="horaInicio" type="time"/>
</div>
<div class="col">
<label class="form-label">Fim</label>
<input class="form-control" id="horaFim" type="time"/>
</div>
</div>
<div class="mb-3">
<label class="form-label">Tipo</label>
<select class="form-select" id="tipoSessao"><option value="">Selecione</option><option value="AniversÃ¡rio">AniversÃ¡rio</option><option value="Ensaio Infantil">Ensaio Infantil</option><option value="Debutante">Debutante</option><option value="Ensaio Gestante">Ensaio Gestante</option><option value="Ensaio Casual">Ensaio Casual</option><option value="Ensaio FamÃ­lia">Ensaio FamÃ­lia</option><option value="Smash The Cake">Smash The Cake</option></select>
</div>
<div class="mb-3">
<label class="form-label">Tema</label>
<input class="form-control" id="temaSessao" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">Pacote</label>
<select class="form-select" id="pacoteSessao"><option value="10 fotos">10 fotos</option><option value="15 fotos">15 fotos</option><option value="20 fotos">20 fotos</option><option value="25 fotos">25 fotos</option><option value="30 fotos">30 fotos</option><option value="35 fotos">35 fotos</option><option value="40 fotos">40 fotos</option><option value="45 fotos">45 fotos</option><option value="50 fotos">50 fotos</option><option value="PrÃ© Festa">PrÃ© Festa</option><option value="Cobertura 2 horas">Cobertura 2 horas</option><option value="Cobertura 3 horas">Cobertura 3 horas</option><option value="Cobertura 4 horas">Cobertura 4 horas</option><option value="Cobertura 5 horas">Cobertura 5 horas</option></select>
</div>
<div class="mb-3"><label class="form-label">Valor do Pacote</label><input class="form-control" id="valorPacote" type="number"/></div><div class="mb-3">
<label class="form-label">Valor da Reserva</label>
<input class="form-control" id="reservaValor" type="number"/>
</div>
<div class="mb-3">
<label class="form-label">Valor no Dia</label>
<input class="form-control" id="valorNoDia" type="number"/>
</div>
<div class="d-grid">
<button class="btn btn-success" onclick="agendar()">Agendar</button>
</div>
</div>
<div id="tela-albuns" style="display:none;">
<h5>ğŸ“š GestÃ£o de Ãlbuns</h5>
<div class="mb-3">
<label class="form-label">ID do Cliente</label>
<input class="form-control" id="idClienteAlbum" placeholder="Ex: 1" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">Tipo de Ãlbum</label>
<select class="form-select" id="tipoAlbum">
<option value="Mini">Mini</option>
<option value="Tradicional">Tradicional</option>
<option value="Premium">Premium</option>
<option value="Super Premium">Super Premium</option>
</select>
<label class="form-label mt-3">Fase do Ãlbum</label>
<select class="form-select" id="faseAlbum">
<option value="SeleÃ§Ã£o enviada">SeleÃ§Ã£o enviada</option>
<option value="Aguardando seleÃ§Ã£o">Aguardando seleÃ§Ã£o</option>
<option value="Montar aprovaÃ§Ã£o">Montar aprovaÃ§Ã£o</option>
<option value="Em confecÃ§Ã£o">Em confecÃ§Ã£o</option>
<option value="Pronto para entrega">Pronto para entrega</option>
</select>
</div>
<div class="d-grid mb-3">
<button class="btn btn-success" onclick="salvarAlbum()">Salvar Fase</button>
</div>
<h6 class="mt-4">ğŸ“‹ Ãlbuns Cadastrados</h6>
<ul class="list-group small" id="listaAlbuns"></ul>
</div>
<div id="tela-ferramentas" style="display:none;">
<h5 class="mb-3">ğŸ§° Ferramentas do Sistema</h5>
<div class="row g-3">
<div class="col-6">
<div class="card shadow-sm border-0 h-100">
<div class="card-body text-center">
<p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
<i class="fas fa-file-export fa-2x text-secondary mb-2"></i>
<h6 class="card-title">Exportar Agenda</h6>
<p class="card-text small">Baixe todos os agendamentos do sistema.</p>
<button class="btn btn-light border w-100" onclick="exportarAgenda()">â¬‡ï¸ Exportar</button>
</div>
</div>
</div>
<div class="col-6">
<div class="card shadow-sm border-0 h-100">
<div class="card-body text-center">
<p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
<i class="fas fa-database fa-2x text-primary mb-2"></i>
<h6 class="card-title">Backup Completo</h6>
<p class="card-text small">Exporta todos os dados do sistema (clientes, agenda, Ã¡lbuns).</p>
<button class="btn btn-light border w-100" onclick="exportarBackup()">ğŸ’¾ Backup</button>
</div>
</div>
</div>
</div>
<div class="row g-3 mt-2">
<div class="col-6">
<div class="card shadow-sm border-0 h-100">
<div class="card-body text-center">
<p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
<i class="fas fa-chart-bar fa-2x text-success mb-2"></i>
<h6 class="card-title">RelatÃ³rio de Agendamentos</h6>
<p class="card-text small">Veja a quantidade de sessÃµes por tipo e mÃªs.</p>
<button class="btn btn-light border w-100" onclick="gerarRelatorioAgendamentos()">ğŸ“Š Ver</button>
</div>
</div>
</div>
<div class="col-6">
</div>
<div class="col-12">
<div class="card shadow-sm border-0">
<div class="card-body text-center">
<p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
<i class="fas fa-upload fa-2x text-info mb-2"></i>
<h6 class="card-title">Importar Backup</h6>
<p class="card-text small">Restaura os dados do sistema a partir de um arquivo .json.</p>
<input accept=".json" class="form-control form-control-sm mb-2" onchange="importarBackup(event)" type="file"/>
</div>
</div>
</div>
</div>
<div class="card mt-4">
<div class="card-body">
<h5 class="card-title">ğŸ”§ Painel de PersonalizaÃ§Ã£o AvanÃ§ada</h5>
<p class="card-text">Edite elementos visuais e funcionais do sistema:</p>
<ul>
<li>ğŸ”  <strong>Renomear abas:</strong> altere os nomes exibidos no menu principal.</li>
<li>ğŸ§© <strong>Mostrar/Ocultar abas:</strong> oculte Ã¡reas que nÃ£o deseja utilizar.</li>
<li>ğŸ·ï¸ <strong>Editar nomes de campos:</strong> personalize os rÃ³tulos de cada Ã¡rea.</li>
<li>ğŸ§® <strong>Configurar cÃ¡lculos:</strong> edite as fÃ³rmulas de receita e despesa.</li>
<li>ğŸ“¦ <strong>Personalizar modais:</strong> altere tÃ­tulos e conteÃºdos.</li>
</ul>
<button class="btn btn-primary mt-2" onclick="togglePainelPersonalizacao()">Abrir Painel</button>
<div id="painel-personalizacao-embutido" style="display:none; margin-top:20px;"><div class="container">
<h1>ğŸ”§ Painel de PersonalizaÃ§Ã£o AvanÃ§ada</h1>
<div class="tabs">
<button class="tab active" onclick="abrirAba('aba-abas', this)">ğŸ“ Abas</button>
<button class="tab" onclick="abrirAba('aba-campos', this)">ğŸ“ Campos</button>
<button class="tab" onclick="abrirAba('aba-calculos', this)">ğŸ§® CÃ¡lculos</button>
<button class="tab" onclick="abrirAba('aba-restauracao', this)">â™»ï¸ RestauraÃ§Ã£o</button>
</div>
<div class="section" id="aba-abas">
<h2>Gerenciar Abas</h2>
<label>De:</label>
<select id="abaDe" onchange="carregarCamposDaAba(this.value)" style="width: 100%; padding: 6px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 0.9rem;"><option value="">Selecione uma aba</option></select>
<label>Para:</label>
<input id="abaPara" placeholder="Ex: Contatos" type="text"/>
<button onclick="salvarRenomearAba()">Salvar RenomeaÃ§Ã£o</button>
<button onclick="excluirAba()" style="background-color: #dc3545; margin-left: 10px;">ğŸ—‘ï¸ Excluir Aba</button>
<label class="mt-3">Criar Nova Aba:</label>
<input id="novaAba" placeholder="Nome da nova aba" type="text"/>
<button onclick="adicionarAba()">Adicionar Aba</button>
</div>
<div class="section" id="aba-campos" style="display:none;">
<h2>Gerenciar Campos</h2>
<label>De:</label>
<select id="campoDe" style="width: 100%; padding: 6px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 0.9rem;"><option value="">Selecione um campo</option></select>
<label>Para:</label>
<input id="campoPara" placeholder="Ex: BÃ´nus Especial" type="text"/>
<button onclick="salvarRenomearCampo()">Salvar RenomeaÃ§Ã£o</button>
<label class="mt-3">Criar Novo Campo:</label>
<input id="novoCampo" placeholder="Nome do novo campo" type="text"/>
<label>Classificar campo:</label>
<select id="classificacaoCampo">
<option value="nenhum">Nenhum</option>
<option value="receita">Receita</option>
<option value="despesa">Despesa</option>
</select>
<button onclick="adicionarCampo()">Adicionar Campo</button>
<button onclick="excluirCampo()" style="background-color: #dc3545; color: white; margin-top: 0.5rem;">
  ğŸ—‘ï¸ Excluir Campo
</button>
</div>
<div class="section" id="aba-calculos" style="display:none;">
<h2>ğŸ§® Editor de FÃ³rmulas por Linhas</h2>
<h3>FÃ³rmula de Receita</h3>
<div id="formulaReceitaContainer"></div>
<button onclick="adicionarLinha('receita')">â• Adicionar Linha</button>
<p><strong>FÃ³rmula:</strong> <span id="previewLinhaReceita"></span></p>
<button onclick="salvarFormulaPorLinha('receita')">ğŸ’¾ Salvar Receita</button>
<button onclick="limparFormulaPorLinha('receita')">ğŸ”„ Limpar Receita</button>
<hr/>
<h3>FÃ³rmula de Despesa</h3>
<div id="formulaDespesaContainer"></div>
<button onclick="adicionarLinha('despesa')">â• Adicionar Linha</button>
<p><strong>FÃ³rmula:</strong> <span id="previewLinhaDespesa"></span></p>
<button onclick="salvarFormulaPorLinha('despesa')">ğŸ’¾ Salvar Despesa</button>
<button onclick="limparFormulaPorLinha('despesa')">ğŸ”„ Limpar Despesa</button>
</div>
<div class="section" id="aba-restauracao" style="display:none;">
<h2>RestauraÃ§Ã£o Seletiva</h2>
<p>âš ï¸ AtenÃ§Ã£o: essa aÃ§Ã£o pode sobrescrever personalizaÃ§Ãµes.</p>
<button onclick="localStorage.clear(); alert('Tudo restaurado! Recarregue a pÃ¡gina.');">ğŸ”„ Restaurar Tudo</button>
</div>
</div></div>
<script>function togglePainelPersonalizacao() { const painel = document.getElementById("painel-personalizacao-embutido"); painel.style.display = painel.style.display === "none" ? "block" : "none"; }</script>
</div>
</div>
</div>
<div id="tela-financeiro" style="display:none;"><h5 class="mb-3">ğŸ’° RelatÃ³rios Financeiros</h5><div class="card border-0 shadow-sm mb-3"><div class="card-body text-center">
<button class="btn btn-success btn-sm m-1" onclick="destacarBotaoRelatorio(this); exibirDashboardFinanceiro()">ğŸ“Š Dashboard</button>
<button class="btn btn-outline-primary btn-sm m-1" onclick="destacarBotaoRelatorio(this); gerarRelatorioFinanceiroCompleto()">ğŸ“‘ RelatÃ³rio Completo</button>
<button class="btn btn-outline-secondary btn-sm m-1" onclick="destacarBotaoRelatorio(this); gerarRelatorioDespesas()">ğŸ§¾ Despesas</button>
<button class="btn btn-outline-info btn-sm m-1" onclick="destacarBotaoRelatorio(this); gerarRelatorioCashback()">ğŸ Cashback</button>
</div></div><div class="mt-3" id="resultadoRelatorio" style="font-size: 0.8rem;"></div></div>
<div id="tela-extra1" style="display:none;">
<div class="mb-3">
<label class="form-label">ğŸ“© Cadastro do Agendamento</label>
<div class="input-group mb-2">
<input class="form-control" id="idAgendamentoTexto" placeholder="ID do agendamento" type="number"/>
<button class="btn btn-outline-primary" onclick="gerarTextoWhatsAppPorID()">Gerar</button>
</div>
<textarea class="form-control" id="mensagemWhatsTexto" readonly="" rows="12"></textarea>
<button class="btn btn-outline-secondary mt-2" onclick="copiarTextoWhatsApp()">ğŸ“‹ Copiar</button>
</div>
<div class="mb-3 d-flex align-items-end">
<div class="me-2" style="flex: 1;">
<label class="form-label">ID do Cliente</label>
<input class="form-control" id="idClienteTextos" placeholder="Ex: 1" type="text"/>
</div>
<button class="btn btn-primary" onclick="gerarTextosCliente()">ğŸ” Gerar Textos</button>
</div>
<div class="mb-3">
<label class="form-label">â° Lembrete da SessÃ£o</label>
<textarea class="form-control" id="textoLembrete" readonly="" rows="4"></textarea>
<button class="btn btn-outline-secondary mt-2" onclick="copiarTexto('textoLembrete')">ğŸ“‹ Copiar</button>
</div>
<div class="mb-3">
<label class="form-label">ğŸ™ Agradecimento PÃ³s-Ensaio / AniversÃ¡rio</label>
<textarea class="form-control" id="textoAgradecimento" readonly="" rows="4"></textarea>
<button class="btn btn-outline-secondary mt-2" onclick="copiarTexto('textoAgradecimento')">ğŸ“‹ Copiar</button>
</div>
<div class="mb-3">
<label class="form-label">ğŸ“¦ Retirada do Ãlbum Impresso</label>
<textarea class="form-control" id="textoAlbum" readonly="" rows="3"></textarea>
<button class="btn btn-outline-secondary mt-2" onclick="copiarTexto('textoAlbum')">ğŸ“‹ Copiar</button>
</div>
<div class="mb-3">
<label class="form-label">ğŸ–¼ï¸ SeleÃ§Ã£o de Fotos Atrasada</label>
<textarea class="form-control" id="textoSelecao" readonly="" rows="3"></textarea>
<button class="btn btn-outline-secondary mt-2" onclick="copiarTexto('textoSelecao')">ğŸ“‹ Copiar</button>
</div>
<div class="mb-3">
<label class="form-label">ğŸ‰ ConfirmaÃ§Ã£o de Evento de AniversÃ¡rio</label>
<textarea class="form-control" id="textoConfirmacao" readonly="" rows="4"></textarea>
<button class="btn btn-outline-secondary mt-2" onclick="copiarTexto('textoConfirmacao')">ğŸ“‹ Copiar</button>
</div>
</div>
<div id="tela-cashback" style="display:none;">
<h5 class="mb-3">ğŸ Controle de Cashback</h5>
<div class="mb-3">
<label class="form-label">ID do Cliente</label>
<input class="form-control" id="idCashbackCliente" placeholder="Ex: 1" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">Valor em Fotos Extras</label>
<input class="form-control" id="valorExtras" placeholder="Ex: 100.00" type="number"/>
</div>
<div class="d-grid mb-2">
<button onclick="adicionarCashbackExtras()" style="background-color: #ffc107; color: black; padding: 6px 10px; border: none; border-radius: 6px; font-size: 0.9rem;">ğŸ’¸ Adicionar Cashback</button>
</div>
<div class="d-grid mb-2">
<button onclick="gerarTextoCashback()" style="background-color: #17a2b8; color: white; padding: 6px 10px; border: none; border-radius: 6px; font-size: 0.9rem;">ğŸ“² Informar Cashback</button>
</div>
<div class="mb-3">
<textarea class="form-control small" id="textoCashback" readonly="" rows="6" style="font-size: 0.9rem;"></textarea>
</div>
<div class="mb-3">
<label class="form-label">Novo valor de cashback</label>
<input class="form-control" id="novoValorCashback" placeholder="Ex: 50.00" type="number"/>
</div>
<div class="d-grid">
<button onclick="editarCashbackCliente()" style="background-color: #ff9800; color: white; padding: 6px 10px; border: none; border-radius: 6px; font-size: 0.9rem;">âœï¸ Editar Cashback</button>
</div>
</div>
</main>
<script>
function mostrarTela(id, btn) {
  const telas = ["tela-extra1", "tela-extra2", 'tela-inicio', 'tela-clientes', 'tela-agenda', 'tela-albuns', 'tela-ferramentas', 'tela-financeiro', "tela-cashback"];
  telas.forEach(telaId => {
    const el = document.getElementById(telaId);
    if (el) {
      el.style.display = (telaId === id) ? 'block' : 'none';
      if (id === 'tela-albuns' && typeof listarAlbuns === 'function') listarAlbuns();
    }
  });

  const botoes = document.getElementsByClassName('navbtn');
  for (let i = 0; i < botoes.length; i++) {
    botoes[i].classList.remove('active');
  }
  if (btn) btn.classList.add('active');
}

window.onload = function () {
  if (typeof listarAlbuns === 'function') listarAlbuns();
  mostrarTela('tela-inicio');
  if (typeof listarClientes === 'function') listarClientes();
  if (typeof listarProximos === 'function') listarProximos();
};

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function listarClientes() {
  const lista = document.getElementById('listaClientes');
  lista.innerHTML = "";

  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  if (clientes.length === 0) {
    lista.innerHTML = "<li class='list-group-item'>Nenhum cliente cadastrado.</li>";
    return;
  }

  clientes.sort((a, b) => a.nome.localeCompare(b.nome));
  clientes.forEach(c => {
    const item = document.createElement('li');
    item.className = "list-group-item";
    item.style.cursor = "pointer";
    item.onclick = function () {
      document.getElementById('nomeCliente').value = c.nome;
      document.getElementById('instagramCliente').value = c.instagram;
      document.getElementById('filhoCliente').value = c.filho;
      document.getElementById('idadeCliente').value = c.idade;
      document.getElementById('postagemCliente').value = c.postagem;
      document.getElementById('cashbackCliente').value = `R$${(c.cashback || 0).toFixed(2)}`;
    };

    item.innerHTML = `
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <strong>${c.nome}</strong> (${c.filho}, ${c.idade} anos)<br>
          ID: ${c.id} | Postagem: <strong>${c.postagem}</strong><br>ğŸ Cashback: R$${(c.cashback || 0).toFixed(2)}
        </div>
        <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); excluirCliente('${c.id}')">Excluir</button>
      </div>
    `;
    lista.appendChild(item);
  });
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function listarProximos() {
  const lista = document.getElementById('listaProximosAgendamentos');
  lista.innerHTML = "";

  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];

  if (agendamentos.length === 0) {
    lista.innerHTML = "<li class='list-group-item'>Nenhum agendamento futuro.</li>";
    return;
  }

  const diasSemana = ['Domingo', 'Segunda-feira', 'TerÃ§a-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'SÃ¡bado'];

  const agendamentosValidos = agendamentos.filter(a => a.data && a.hora && /^\d{4}-\d{2}-\d{2}$/.test(a.data) && /^\d{2}:\d{2}$/.test(a.hora));
  agendamentosValidos.sort((a, b) => new Date(a.data + 'T' + a.hora) - new Date(b.data + 'T' + b.hora));

  agendamentosValidos.forEach(a => {
    const dataObj = new Date(a.data + 'T' + a.hora);
    const diaSemana = diasSemana[dataObj.getDay()];
    const dataFormatada = dataObj.toLocaleDateString('pt-BR');
    const horaFormatada = a.hora;
    const restante = (a.valorDia !== undefined && a.reserva !== undefined) ? (a.valorDia - a.reserva) : 0;

    const item = document.createElement('li');
    item.className = "list-group-item";
    item.innerHTML = `
      <strong>ID ${a.id}</strong> - ğŸ“… <strong>${dataFormatada}</strong> - ${diaSemana} - ${horaFormatada}<br>
      ğŸ“¸ Tipo: <strong>${a.tipo}</strong><br>
      ğŸ¨ Tema: <strong>${a.tema}</strong><br>
      ğŸ‘¤ Cliente: <strong>${a.nome}</strong><br>
      ğŸ“¦ Pacote: <strong>${a.pacote}</strong><br>
      <div class='d-flex justify-content-between align-items-center'>ğŸ’° Reserva: R$${a.reserva.toFixed(2)} | ğŸ’³ Restante: R$ R\$${a.valorDia.toFixed(2)}</div><div class='text-end'>

<button class='btn btn-sm btn-outline-primary mt-1' onclick='abrirFinalizarModalPorID(${a.id})' onclick='abrirFinalizarModalPorID(${a.id})'>Finalizar</button>


    `;
    lista.appendChild(item);
  });
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function limparTodosAgendamentos() {
  if (confirm("Tem certeza que deseja excluir TODOS os agendamentos?")) {
    localStorage.removeItem('agendamentos');
    listarProximos();
    alert("Todos os agendamentos foram removidos.");
  }
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function excluirCliente(id) {
  let clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  clientes = clientes.filter(c => c.id.toString() !== id.toString());
  localStorage.setItem('clientes', JSON.stringify(clientes));
  listarClientes();
  alert("Cliente excluÃ­do com sucesso!");
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function gerarTextoWhatsApp() {
  const idCliente = document.getElementById('idCliente').value.trim();
  const data = document.getElementById('dataAgenda').value;
  const horaInicio = document.getElementById('horaInicio').value;
  const horaFim = document.getElementById('horaFim').value;
  const tipo = document.getElementById('tipoSessao').value;
  const tema = document.getElementById('temaSessao').value;
  const pacote = document.getElementById('pacoteSessao').value;
  const reserva = parseFloat(document.getElementById('reservaValor').value || 0);
  const valorDia = parseFloat(document.getElementById('valorNoDia').value || 0);
  const cashback = Math.floor(reserva / 50) * 5;

  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const cliente = clientes.find(c => c.id === idCliente);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  const totalCashback = cliente.cashback + cashback;
  const nome = cliente.nome;
  const dataObj = new Date(data + "T00:00");
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  let mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” ID do Cliente: ${idCliente}

ğŸ“¸ Tipo de sessÃ£o: ${tipo}
ğŸ¨ Tema: ${tema}
ğŸ“¦ Pacote escolhido: ${pacote}
ğŸ“ Data: ${diaSemana}, ${dataFormatada}
ğŸ•’ HorÃ¡rio: ${horaInicio} Ã s ${horaFim}

ğŸ’° Valor da reserva: R$${reserva.toFixed(2)}
ğŸ’³ Valor a pagar no dia: R$${valorDia.toFixed(2)}
ğŸ Cashback gerado: R$${cashback}
ğŸ’¼ Cashback acumulado: R$${totalCashback.toFixed(2)}

ğŸ“Œ Local: Rodrigo Costa Fotografia  
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

ğŸ“£ ObservaÃ§Ã£o: a cada R$50 de reserva, vocÃª acumula R$5 em cashback, que pode ser usado em sessÃµes futuras!

Qualquer dÃºvida, Ã© sÃ³ me chamar!
âœ¨ Vai ser um prazer registrar esse momento especial com vocÃªs!

Atenciosamente,  
Rodrigo Costa`;

  navigator.clipboard.writeText(mensagem)
    .then(() => alert("Texto copiado para a Ã¡rea de transferÃªncia!"))
    .catch(() => alert("Erro ao copiar o texto."));
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function excluirAgendamentoPorID() {
  const idInput = document.getElementById('idParaExcluir').value.trim();
  const id = parseInt(idInput);

  if (isNaN(id)) {
    alert("Digite um ID vÃ¡lido (nÃºmero).");
    return;
  }

  let agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const agendamentoExiste = agendamentos.some(a => parseInt(a.id) === id);

  if (!agendamentoExiste) {
    alert("Agendamento com esse ID nÃ£o encontrado.");
    return;
  }

  if (!confirm(`Tem certeza que deseja excluir o agendamento ID ${id}?`)) {
    return;
  }

  agendamentos = agendamentos.filter(a => parseInt(a.id) !== id);
  localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
  document.getElementById('idParaExcluir').value = "";
  listarProximos();
  alert("Agendamento excluÃ­do com sucesso!");
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function limparAgendamentosIndefinidos() {
  let agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const originalLength = agendamentos.length;
  agendamentos = agendamentos.filter(a => a.id !== undefined && a.id !== "undefined");
  localStorage.setItem("agendamentos", JSON.stringify(agendamentos));
  listarProximos();
  alert(`Removidos ${originalLength - agendamentos.length} agendamentos com ID indefinido.`);
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>// FunÃ§Ã£o substituÃ­da para compatibilidade com mobile.
function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function buscarClientePorID() {
  const id = document.getElementById("buscarIdCliente").value.trim();
  if (!id) {
    alert("Informe um ID para buscar.");
    return;
  }

  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const cliente = clientes.find(c => c.id === id);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  document.getElementById('nomeCliente').value = cliente.nome;
  document.getElementById('instagramCliente').value = cliente.instagram;
  document.getElementById('filhoCliente').value = cliente.filho;
  document.getElementById('idadeCliente').value = cliente.idade;
  document.getElementById('postagemCliente').value = cliente.postagem;
  document.getElementById('cashbackCliente').value = `R$${(cliente.cashback || 0).toFixed(2)}`;
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script><script>
document.getElementById("valorPacote").addEventListener("input", atualizarValorNoDia);
document.getElementById("reservaValor").addEventListener("input", atualizarValorNoDia);

function atualizarValorNoDia() {
  const pacote = parseFloat(document.getElementById("valorPacote").value) || 0;
  const reserva = parseFloat(document.getElementById("reservaValor").value) || 0;
  const restante = pacote - reserva;
  document.getElementById("valorNoDia").value = restante >= 0 ? restante.toFixed(2) : "";
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script><script>
function agendar() {
  const idCliente = document.getElementById('idCliente').value.trim();
  const data = document.getElementById('dataAgenda').value;
  const horaInicio = document.getElementById('horaInicio').value;
  const horaFim = document.getElementById('horaFim').value;
  const tipo = document.getElementById('tipoSessao').value;
  const tema = document.getElementById('temaSessao').value;
  const pacote = document.getElementById('pacoteSessao').value;
  const valorPacote = parseFloat(document.getElementById('valorPacote').value || 0);
  const reserva = parseFloat(document.getElementById('reservaValor').value || 0);
  const valorDia = parseFloat(document.getElementById('valorNoDia').value || 0);
  const cashback = Math.round(valorPacote * 0.05);

  if (!idCliente || !data || !horaInicio || !tema || isNaN(valorPacote)) {
    alert("Preencha todos os campos obrigatÃ³rios.");
    return;
  }

  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const cliente = clientes.find(c => c.id === idCliente);
  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  cliente.cashback = (cliente.cashback || 0) + cashback;
  localStorage.setItem('clientes', JSON.stringify(clientes));

  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const novoId = agendamentos.length > 0 ? Math.max(...agendamentos.map(a => a.id || 0)) + 1 : 1;

  const agendamento = {
    id: novoId,
    idCliente,
    nome: cliente.nome,
    data,
    hora: horaInicio,
    fim: horaFim,
    tipo,
    tema,
    pacote,
    valorPacote,
    reserva,
    valorDia,
    cashback
  };

  agendamentos.push(agendamento);
  localStorage.setItem('agendamentos', JSON.stringify(agendamentos));

  alert("Agendamento salvo com sucesso!");

  document.getElementById('idCliente').value = "";
  document.getElementById('dataAgenda').value = "";
  document.getElementById('horaInicio').value = "";
  document.getElementById('horaFim').value = "";
  document.getElementById('tipoSessao').value = "";
  document.getElementById('temaSessao').value = "";
  document.getElementById('pacoteSessao').value = "";
  document.getElementById('valorPacote').value = "";
  document.getElementById('reservaValor').value = "";
  document.getElementById('valorNoDia').value = "";

  if (typeof listarProximos === 'function') listarProximos();
  mostrarTela('tela-inicio');
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}



function adicionarCashbackExtras() {
  const id = document.getElementById("idCashbackCliente").value.trim();
  const extras = parseFloat(document.getElementById("valorExtras").value || 0);

  if (!id || isNaN(extras) || extras <= 0) {
    alert("Informe o ID do cliente e um valor vÃ¡lido.");
    return;
  }

  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const cliente = clientes.find(c => c.id.toString() === id);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  const cashbackAdicional = Math.floor(extras / 50) * 5;
  cliente.cashback = (cliente.cashback || 0) + cashbackAdicional;

  localStorage.setItem("clientes", JSON.stringify(clientes));
  alert(`Cashback de R$${cashbackAdicional.toFixed(2)} adicionado com sucesso!`);
}




function gerarTextoCashback() {
  const id = document.getElementById("idCashbackCliente").value.trim();
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const cliente = clientes.find(c => c.id.toString() === id);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  const nome = cliente.nome.toUpperCase();
  const valor = (cliente.cashback || 0).toFixed(2);

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

VocÃª possui atualmente R$${valor} de cashback acumulado conosco! ğŸâœ¨  
Esse valor Ã© um presente especial pensado para vocÃª continuar registrando seus melhores momentos.

Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial.

ğŸ“¸ Que tal aproveitar essa oportunidade para fazer aquele ensaio que vocÃª vem pensando ou garantir um presente inesquecÃ­vel para alguÃ©m?

âš ï¸ Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado.

âœ… Regras de uso:
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva

ğŸ’¡ Aproveite enquanto ainda estÃ¡ disponÃ­vel! Momentos especiais merecem ser registrados â€” e seu cashback estÃ¡ aqui para ajudar com isso. ğŸ˜

Se quiser agendar ou tirar dÃºvidas, Ã© sÃ³ me chamar!

Com carinho,  
Rodrigo Costa ğŸ“¸`;

  document.getElementById("textoCashback").value = mensagem;
}



function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function salvarCliente() {
  const idCampo = document.getElementById("buscarIdCliente");
  const nome = document.getElementById("nomeCliente").value.trim();
  const instagram = document.getElementById("instagramCliente").value.trim();
  const filho = document.getElementById("filhoCliente").value.trim();
  const idade = document.getElementById("idadeCliente").value.trim();
  const postagem = document.getElementById("postagemCliente").value;

  if (!nome || !filho || !idade) {
    alert("Preencha os campos obrigatÃ³rios: nome, filho(a) e idade.");
    return;
  }

  let clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  let clienteExistente = null;

  if (idCampo.value) {
    clienteExistente = clientes.find(c => c.id === idCampo.value);
  }

  let novoId = "1";
  if (!clienteExistente) {
    const idsExistentes = clientes.map(c => parseInt(c.id)).filter(n => !isNaN(n));
    novoId = idsExistentes.length > 0 ? (Math.max(...idsExistentes) + 1).toString() : "1";
  }

  const novoCliente = {
    id: clienteExistente ? clienteExistente.id : novoId,
    nome,
    instagram,
    filho,
    idade,
    postagem,
    cashback: clienteExistente ? clienteExistente.cashback || 0 : 0
  };

  if (clienteExistente) {
    clientes = clientes.map(c => c.id === clienteExistente.id ? novoCliente : c);
  } else {
    clientes.push(novoCliente);
  }

  localStorage.setItem("clientes", JSON.stringify(clientes));
  alert("Cliente salvo com sucesso!");

  idCampo.value = "";
  document.getElementById("nomeCliente").value = "";
  document.getElementById("instagramCliente").value = "";
  document.getElementById("filhoCliente").value = "";
  document.getElementById("idadeCliente").value = "";
  document.getElementById("postagemCliente").value = "Sim";
  document.getElementById("cashbackCliente").value = "R$0,00";

  if (typeof listarClientes === "function") listarClientes();
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function zerarCashbacks() {
  const hoje = new Date();
  const dataLimite = new Date("2025-12-31T23:59:59");

  if (hoje > dataLimite) {
    let clientes = JSON.parse(localStorage.getItem("clientes")) || [];
    let houveAlteracao = false;

    clientes.forEach(c => {
      if (c.cashback && c.cashback > 0) {
        c.cashback = 0;
        houveAlteracao = true;
      }
    });

    if (houveAlteracao) {
      localStorage.setItem("clientes", JSON.stringify(clientes));
      if (typeof listarClientes === "function") listarClientes();
      console.log("Cashbacks expirados foram zerados.");
    }
  }
}

// Rodar ao abrir o sistema
window.addEventListener("load", zerarCashbacks);

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


let mesAtual = new Date().getMonth();
let anoAtual = new Date().getFullYear();

function mudarMes(offset) {
  mesAtual += offset;
  if (mesAtual > 11) {
    mesAtual = 0;
    anoAtual++;
  } else if (mesAtual < 0) {
    mesAtual = 11;
    anoAtual--;
  }
  gerarCalendario();
}

function gerarCalendario() {
  const container = document.getElementById('calendarioAgendamentos');
  const label = document.getElementById('mesAtualLabel');
  const eventosDoDia = document.getElementById('eventosDoDia');

  container.innerHTML = "";
  eventosDoDia.style.display = "none";
  eventosDoDia.innerHTML = "";

  const nomesMeses = ['Janeiro','Fevereiro','MarÃ§o','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
  label.textContent = `${nomesMeses[mesAtual]} / ${anoAtual}`;

  const primeiroDia = new Date(anoAtual, mesAtual, 1);
  const ultimoDia = new Date(anoAtual, mesAtual + 1, 0);
  const diasNoMes = ultimoDia.getDate();
  const diaSemanaInicio = primeiroDia.getDay();

  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const mapaDias = {};

  agendamentos.forEach(a => {
    const dataObj = new Date(a.data + 'T00:00');
    if (dataObj.getMonth() === mesAtual && dataObj.getFullYear() === anoAtual) {
      const dia = dataObj.getDate();
      const tipo = (a.tipo || '').toLowerCase();
      let cor = '';
      if (['ensaio infantil', 'ensaio casual', 'ensaio famÃ­lia', 'prÃ© festa'].some(t => tipo.includes(t))) cor = 'cal-verde';
      else if (tipo.includes('aniversÃ¡rio')) cor = 'cal-azul';
      else if (tipo.includes('gestante')) cor = 'cal-roxo';
      else if (tipo.includes('smash')) cor = 'cal-laranja';
      if (!mapaDias[dia]) mapaDias[dia] = [];
      mapaDias[dia].push({ cor, info: a });
    }
  });

  const calendario = document.createElement('div');
  calendario.className = "calendar";

  for (let i = 0; i < diaSemanaInicio; i++) {
    const vazio = document.createElement('div');
    calendario.appendChild(vazio);
  }

  for (let dia = 1; dia <= diasNoMes; dia++) {
    const celula = document.createElement('div');
    celula.className = "calendar-day";
    const diaSpan = document.createElement('span');
    diaSpan.textContent = dia;
    celula.appendChild(diaSpan);

    if (mapaDias[dia]) {
      mapaDias[dia].forEach(obj => {
        const barra = document.createElement('div');
        barra.className = `barra-cor ${obj.cor}`;
        celula.appendChild(barra);
      });

      celula.style.cursor = "pointer";
      celula.onclick = () => {
        eventosDoDia.style.display = "block";
        eventosDoDia.innerHTML = `<strong>Agendamentos de ${dia} ${nomesMeses[mesAtual]}:</strong><br><ul style='padding-left: 18px;'>` +
          mapaDias[dia].map(obj => `<li>${obj.info.tipo} - ${obj.info.nome} - ${obj.info.hora || ''}</li>`).join('') + "</ul>";
      };
    }

    calendario.appendChild(celula);
  }

  container.appendChild(calendario);
}

function exportarAgenda() {
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const linhas = agendamentos.map(a =>
    `ID ${a.id}; ${a.data}; ${a.hora}; ${a.tipo}; ${a.tema}; ${a.nome}; ${a.pacote}; R$${a.reserva}; R$${a.valorDia}`
  );
  const conteudo = "data:text/plain;charset=utf-8," + encodeURIComponent(linhas.join("\n"));
  const link = document.createElement("a");
  link.setAttribute("href", conteudo);
  link.setAttribute("download", "agenda_rcf.txt");
  link.click();
}

window.addEventListener("load", () => {
  const hoje = new Date();
  mesAtual = hoje.getMonth();
  anoAtual = hoje.getFullYear();
  gerarCalendario();
});

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function exportarBackup() {
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const albuns = JSON.parse(localStorage.getItem('albuns')) || [];

  const backup = {
    clientes,
    agendamentos,
    albuns
  };

  const conteudo = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(backup, null, 2));
  const link = document.createElement("a");
  link.setAttribute("href", conteudo);
  link.setAttribute("download", "backup_rcf.json");
  link.click();
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function importarBackup(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const dados = JSON.parse(e.target.result);
      if (dados.clientes) localStorage.setItem('clientes', JSON.stringify(dados.clientes));
      if (dados.agendamentos) localStorage.setItem('agendamentos', JSON.stringify(dados.agendamentos));
      if (dados.albuns) localStorage.setItem('albuns', JSON.stringify(dados.albuns));
      alert("Backup importado com sucesso!");
      location.reload();
    } catch (err) {
      alert("Erro ao importar backup: " + err.message);
    }
  };
  reader.readAsText(file);
}

function gerarRelatorioAgendamentos() {
  const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];
  const resultado = document.getElementById("resultadoRelatorio");
  if (agendamentos.length === 0) {
    resultado.innerHTML = "<div class='alert alert-warning'>Nenhum agendamento registrado.</div>";
    return;
  }

  const tipos = {};
  const meses = {};

  agendamentos.forEach(a => {
    tipos[a.tipo] = (tipos[a.tipo] || 0) + 1;
    const d = new Date(a.data);
    const chaveMes = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2, '0')}`;
    meses[chaveMes] = (meses[chaveMes] || 0) + 1;
  });

  let html = "<h6>ğŸ“¸ SessÃµes por Tipo</h6><ul>";
  for (let tipo in tipos) {
    html += `<li>${tipo}: ${tipos[tipo]}</li>`;
  }
  html += "</ul><h6>ğŸ—“ï¸ SessÃµes por MÃªs</h6><ul>";
  Object.keys(meses).sort().forEach(m => {
    html += `<li>${m}: ${meses[m]}</li>`;
  });
  html += "</ul>";

  resultado.innerHTML = html;
}

function gerarRelatorioFinanceiro() {
  const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];
  const resultado = document.getElementById("resultadoRelatorio");
  if (agendamentos.length === 0) {
    resultado.innerHTML = "<div class='alert alert-warning'>Nenhum dado financeiro disponÃ­vel.</div>";
    return;
  }

  let totalReserva = 0;
  let totalDia = 0;

  agendamentos.forEach(a => {
    totalReserva += parseFloat(a.reserva || 0);
    totalDia += parseFloat(a.valorDia || 0);
  });

  const total = totalReserva + totalDia;
  const media = agendamentos.length ? total / agendamentos.length : 0;

  resultado.innerHTML = `
    <h6>ğŸ’° Resumo Financeiro</h6>
    <ul>
      <li>Total de Reservas: R$ ${totalReserva.toFixed(2)}</li>
      <li>Total a Receber no Dia: R$ ${totalDia.toFixed(2)}</li>
      <li>Receita Total Estimada: R$ ${total.toFixed(2)}</li>
      <li>MÃ©dia por SessÃ£o: R$ ${media.toFixed(2)}</li>
    </ul>
  `;
}

function abrirFinalizarModalPorID(id) {
  document.getElementById('finalizarId').value = id;
  const modal = new bootstrap.Modal(document.getElementById('finalizarModal'));
  modal.show();
}


function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<!-- Modal de FinalizaÃ§Ã£o -->
<div aria-hidden="true" aria-labelledby="finalizarModalLabel" class="modal fade" id="finalizarModal" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="finalizarModalLabel">Finalizar Agendamento</h5>
<button aria-label="Fechar" class="btn-close" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body">
<input id="finalizarId" type="hidden"/>
<div class="mb-2">
<label>Uber (R$)</label>
<input class="form-control" id="finalizarUber" type="number"/>
</div>
<div class="mb-2">
<label>Ãlbum (R$)</label>
<input class="form-control" id="finalizarAlbum" type="number"/>
</div>
<div class="mb-2">
<label>Outras despesas (R$)</label>
<input class="form-control" id="finalizarOutras" type="number"/>
</div>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Cancelar</button>
<button class="btn btn-success" onclick="salvarDespesas()" type="button">Salvar</button>
</div>
</div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function salvarDespesas() {
  const id = parseInt(document.getElementById('finalizarId').value);
  const uber = parseFloat(document.getElementById('finalizarUber').value) || 0;
  const album = parseFloat(document.getElementById('finalizarAlbum').value) || 0;
  const outras = parseFloat(document.getElementById('finalizarOutras').value) || 0;

  let agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const agendamento = agendamentos.find(a => a.id === id);

  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  let despesas = JSON.parse(localStorage.getItem('despesas')) || [];
  despesas.push({
    idAgendamento: id,
    nome: agendamento.nome,
    data: agendamento.data,
    tipo: agendamento.tipo,
    tema: agendamento.tema,
    uber,
    album,
    outras,
    total: uber + album + outras
  });
  localStorage.setItem('despesas', JSON.stringify(despesas));

  agendamentos = agendamentos.filter(a => a.id !== id);
  localStorage.setItem('agendamentos', JSON.stringify(agendamentos));

  document.getElementById('finalizarId').value = "";
  document.getElementById('finalizarUber').value = "";
  document.getElementById('finalizarAlbum').value = "";
  document.getElementById('finalizarOutras').value = "";

  if (typeof listarProximos === 'function') listarProximos();

  const modal = bootstrap.Modal.getInstance(document.getElementById('finalizarModal'));
  modal.hide();

  alert("Despesas salvas e agendamento finalizado com sucesso!");
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function gerarRelatorioFinanceiroCompleto() {
  const despesas = JSON.parse(localStorage.getItem('despesas')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];

  const resultado = document.getElementById("resultadoRelatorio");

  // Receita dos pacotes dos agendamentos
  const receitaPacotes = agendamentos.reduce((sum, a) => sum + (parseFloat(a.valorPacote) || 0), 0);

  // Receita de fotos extras
  let receitaExtras = 0;
  clientes.forEach(c => {
    receitaExtras += parseFloat(c.fotosExtras || 0);
  });

  // Total Receita
  const totalReceita = receitaPacotes + receitaExtras;

  // Total Despesas
  const totalDespesas = despesas.reduce((sum, d) => sum + (d.uber + d.album + d.outras), 0);

  const lucro = totalReceita - totalDespesas;

  let html = `
    <h6>ğŸ’° RelatÃ³rio Financeiro</h6>
    <ul>
      <li>ğŸ“¦ Receita de Pacotes: R$ ${receitaPacotes.toFixed(2)}</li>
      <li>ğŸ–¼ï¸ Receita de Fotos Extras: R$ ${receitaExtras.toFixed(2)}</li>
      <li>ğŸ’¸ Receita Total: <strong>R$ ${totalReceita.toFixed(2)}</strong></li>
      <li>ğŸ“‘ Despesas Totais: <strong>R$ ${totalDespesas.toFixed(2)}</strong></li>
      <li>ğŸ“Š Lucro LÃ­quido: <strong>R$ ${lucro.toFixed(2)}</strong></li>
    </ul>
  `;

  resultado.innerHTML = html;
}

function gerarRelatorioDespesas() {
  const despesas = JSON.parse(localStorage.getItem('despesas')) || [];
  const resultado = document.getElementById("resultadoRelatorio");

  if (despesas.length === 0) {
    resultado.innerHTML = "<div class='alert alert-warning'>Nenhuma despesa registrada.</div>";
    return;
  }

  let totalDespesas = 0;
  let html = "<h6>ğŸ“‘ Despesas Registradas</h6><ul>";

  despesas.forEach(d => {
    const total = d.total;
    totalDespesas += total;
    html += `<li>
      ğŸ†” ${d.idAgendamento} - ${d.nome} (${d.data})<br>
      Uber: R$ ${d.uber.toFixed(2)}, Ãlbum: R$ ${d.album.toFixed(2)}, Outras: R$ ${d.outras.toFixed(2)}<br>
      <strong>Total:</strong> R$ ${total.toFixed(2)}
    </li>`;
  });

  html += `</ul><h6>ğŸ’¸ Total em Despesas: R$ ${totalDespesas.toFixed(2)}</h6>`;
  resultado.innerHTML = html;
}

function gerarRelatorioCashback() {
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const resultado = document.getElementById("resultadoRelatorio");

  if (clientes.length === 0) {
    resultado.innerHTML = "<div class='alert alert-warning'>Nenhum cliente encontrado.</div>";
    return;
  }

  let totalCashback = 0;
  let html = "<h6>ğŸ RelatÃ³rio de Cashback</h6><ul>";

  clientes.forEach(c => {
    const cashback = parseFloat(c.cashback) || 0;
    totalCashback += cashback;
    html += `<li>ğŸ†” ${c.id} - ${c.nome}: R$ ${cashback.toFixed(2)}</li>`;
  });

  html += `</ul><h6>ğŸ’¼ Total de Cashback Acumulado: <strong>R$ ${totalCashback.toFixed(2)}</strong></h6>`;
  resultado.innerHTML = html;
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function exibirDashboardFinanceiro() {
  const despesas = JSON.parse(localStorage.getItem('despesas')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];

  const receitaPacotes = agendamentos.reduce((sum, a) => sum + (parseFloat(a.valorPacote) || 0), 0);
  const receitaExtras = clientes.reduce((sum, c) => sum + (parseFloat(c.fotosExtras) || 0), 0);
  const totalReceita = receitaPacotes + receitaExtras;

  const totalDespesas = despesas.reduce((sum, d) => sum + (d.uber + d.album + d.outras), 0);
  const lucro = totalReceita - totalDespesas;
  const totalCashback = clientes.reduce((sum, c) => sum + (parseFloat(c.cashback) || 0), 0);

  const resultado = document.getElementById("resultadoRelatorio");
  resultado.innerHTML = `
    <div class="row g-3">
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          
<div class="card-body text-center">
  <p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
  

            <i class="fas fa-coins fa-2x text-success mb-2"></i>
            <h6 class="card-title">Receita Total</h6>
            <p class="card-text">R$ ${totalReceita.toFixed(2)}</p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          
<div class="card-body text-center">
  <p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
  

            <i class="fas fa-wallet fa-2x text-danger mb-2"></i>
            <h6 class="card-title">Despesas Totais</h6>
            <p class="card-text">R$ ${totalDespesas.toFixed(2)}</p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          
<div class="card-body text-center">
  <p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
  

            <i class="fas fa-chart-line fa-2x text-primary mb-2"></i>
            <h6 class="card-title">Lucro LÃ­quido</h6>
            <p class="card-text">R$ ${lucro.toFixed(2)}</p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          
<div class="card-body text-center">
  <p class="small text-muted">RelatÃ³rios financeiros completos e detalhados.</p>
  

            <i class="fas fa-gift fa-2x text-warning mb-2"></i>
            <h6 class="card-title">Cashback Acumulado</h6>
            <p class="card-text">R$ ${totalCashback.toFixed(2)}</p>
          </div>
        </div>
      </div>
    </div>
  `;
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function gerarRelatorioFinanceiroCompleto() {
  const despesas = JSON.parse(localStorage.getItem('despesas')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];

  const receitaPacotes = agendamentos.reduce((sum, a) => sum + (parseFloat(a.valorPacote) || 0), 0);
  const receitaExtras = clientes.reduce((sum, c) => sum + (parseFloat(c.fotosExtras) || 0), 0);
  const totalReceita = receitaPacotes + receitaExtras;

  const totalDespesas = despesas.reduce((sum, d) => sum + (d.uber + d.album + d.outras), 0);
  const lucro = totalReceita - totalDespesas;

  const resultado = document.getElementById("resultadoRelatorio");
  resultado.innerHTML = `
    <h6>ğŸ’° RelatÃ³rio Financeiro Detalhado</h6>
    <ul>
      <li>ğŸ“¦ Receita de Pacotes: R$ ${receitaPacotes.toFixed(2)}</li>
      <li>ğŸ–¼ï¸ Receita de Fotos Extras: R$ ${receitaExtras.toFixed(2)}</li>
      <li>ğŸ’¸ Receita Total: <strong>R$ ${totalReceita.toFixed(2)}</strong></li>
      <li>ğŸ“‘ Despesas Totais: <strong>R$ ${totalDespesas.toFixed(2)}</strong></li>
      <li>ğŸ“Š Lucro LÃ­quido: <strong>R$ ${lucro.toFixed(2)}</strong></li>
    </ul>
  `;
}

function gerarRelatorioDespesas() {
  const despesas = JSON.parse(localStorage.getItem('despesas')) || [];
  const resultado = document.getElementById("resultadoRelatorio");

  if (despesas.length === 0) {
    resultado.innerHTML = "<div class='alert alert-warning'>Nenhuma despesa registrada.</div>";
    return;
  }

  let totalDespesas = 0;
  let html = "<h6>ğŸ“‘ Despesas Registradas</h6><ul>";

  despesas.forEach(d => {
    const total = d.total;
    totalDespesas += total;
    html += `<li>
      ğŸ†” ${d.idAgendamento} - ${d.nome} (${d.data})<br>
      Uber: R$ ${d.uber.toFixed(2)}, Ãlbum: R$ ${d.album.toFixed(2)}, Outras: R$ ${d.outras.toFixed(2)}<br>
      <strong>Total:</strong> R$ ${total.toFixed(2)}
    </li>`;
  });

  html += `</ul><h6>ğŸ’¸ Total em Despesas: R$ ${totalDespesas.toFixed(2)}</h6>`;
  resultado.innerHTML = html;
}

function gerarRelatorioCashback() {
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const resultado = document.getElementById("resultadoRelatorio");

  if (clientes.length === 0) {
    resultado.innerHTML = "<div class='alert alert-warning'>Nenhum cliente encontrado.</div>";
    return;
  }

  let totalCashback = 0;
  let html = "<h6>ğŸ RelatÃ³rio de Cashback</h6><ul>";

  clientes.forEach(c => {
    const cashback = parseFloat(c.cashback) || 0;
    totalCashback += cashback;
    html += `<li>ğŸ†” ${c.id} - ${c.nome}: R$ ${cashback.toFixed(2)}</li>`;
  });

  html += `</ul><h6>ğŸ’¼ Total de Cashback Acumulado: <strong>R$ ${totalCashback.toFixed(2)}</strong></h6>`;
  resultado.innerHTML = html;
}

function exibirDashboardFinanceiro() {
  const despesas = JSON.parse(localStorage.getItem('despesas')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];

  const receitaPacotes = agendamentos.reduce((sum, a) => sum + (parseFloat(a.valorPacote) || 0), 0);
  const receitaExtras = clientes.reduce((sum, c) => sum + (parseFloat(c.fotosExtras) || 0), 0);
  const totalReceita = receitaPacotes + receitaExtras;

  const totalDespesas = despesas.reduce((sum, d) => sum + (d.uber + d.album + d.outras), 0);
  const lucro = totalReceita - totalDespesas;
  const totalCashback = clientes.reduce((sum, c) => sum + (parseFloat(c.cashback) || 0), 0);

  const resultado = document.getElementById("resultadoRelatorio");
  resultado.innerHTML = `
    <div class="row g-3">
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          <div class="card-body text-center small text-muted"><i class="fas fa-coins mb-1" style="font-size:1.2rem;"></i>
            <h6 class="card-title">Receita Total</h6>
            <p class="card-text">R$ ${totalReceita.toFixed(2)}</p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          <div class="card-body text-center small text-muted"><i class="fas fa-wallet mb-1" style="font-size:1.2rem;"></i>
            <h6 class="card-title">Despesas Totais</h6>
            <p class="card-text">R$ ${totalDespesas.toFixed(2)}</p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          <div class="card-body text-center small text-muted"><i class="fas fa-chart-line mb-1" style="font-size:1.2rem;"></i>
            <h6 class="card-title">Lucro LÃ­quido</h6>
            <p class="card-text">R$ ${lucro.toFixed(2)}</p>
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="card shadow-sm border-0 h-100">
          <div class="card-body text-center small text-muted"><i class="fas fa-gift mb-1" style="font-size:1.2rem;"></i>
            <h6 class="card-title">Cashback Acumulado</h6>
            <p class="card-text">R$ ${totalCashback.toFixed(2)}</p>
          </div>
        </div>
      </div>
    </div>
  `;
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>
function gerarTextosCliente() {
  const id = document.getElementById("idClienteTextos").value.trim();
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const cliente = clientes.find(c => c.id === id);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  const nome = cliente.nome;
  const filho = cliente.filho;
  const idade = cliente.idade;
  const cashback = (cliente.cashback || 0).toFixed(2);

  const textoLembrete = `OlÃ¡, ${nome}! Tudo pronto para a nossa sessÃ£o de fotos! ğŸ“¸
Lembre-se de chegar no horÃ¡rio combinado e trazer tudo o que combinamos para o ensaio do(a) ${filho}!

Vai ser incrÃ­vel! Qualquer dÃºvida, estou por aqui! ğŸ˜Š`;

  const textoAgradecimento = `Oi, ${nome}! Foi um prazer fotografar o(a) ${filho}! ğŸ’•
Espero que tenham curtido a experiÃªncia tanto quanto eu!
AgradeÃ§o pela confianÃ§a e carinho. âœ¨
Logo mais envio uma prÃ©via para matar a curiosidade!`;

  const textoCashbackResumo = `ğŸ OlÃ¡, ${nome}!

VocÃª possui R$${cashback} de cashback disponÃ­vel!
Esse valor pode ser usado como desconto em sessÃµes futuras ou atÃ© para presentear alguÃ©m. ğŸ˜Š

Se quiser aproveitar, Ã© sÃ³ me chamar!`;

  document.getElementById("textoLembrete").value = textoLembrete;
  document.getElementById("textoAgradecimento").value = textoAgradecimento;
  document.getElementById("textoCashbackResumo").value = textoCashbackResumo;

  navigator.clipboard.writeText(`${textoLembrete}\n\n${textoAgradecimento}\n\n${textoCashbackResumo}`)
    .then(() => alert("Todos os textos foram gerados e copiados!"))
    .catch(() => alert("Erro ao copiar os textos."));
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script><script>
function gerarTextosCliente() {
  const id = document.getElementById("idClienteTextos").value.trim();
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const cliente = clientes.find(c => c.id === id);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  const nome = cliente.nome.toUpperCase();
  const filho = cliente.filho;
  const idade = cliente.idade;

  document.getElementById("textoLembrete").value = `OlÃ¡, ADRIANA! Tudo pronto para a nossa sessÃ£o de fotos! ğŸ“¸  
Lembre-se de chegar no horÃ¡rio combinado, entramos no estÃºdio descalÃ§os para manter o ambiente limpo para os bebes, em caso de ensaio casual traga seus calÃ§ados separados limpos.
Te aguardo, atÃ©!`;

  document.getElementById("textoAgradecimento").value = `Oi, ${nome}! Foi um prazer fotografar o(a) ${filho}! ğŸ’•
Espero que tenham curtido a experiÃªncia tanto quanto eu!
AgradeÃ§o pela confianÃ§a e carinho. âœ¨
Logo mais envio uma prÃ©via para matar a curiosidade!`;

  document.getElementById("textoAlbum").value = `Oi, ${nome}! Seu Ã¡lbum impresso estÃ¡ pronto para retirada. ğŸ“šâœ¨
Podemos combinar um horÃ¡rio para vocÃª vir buscar? Vai ser um prazer te receber aqui novamente!`;

  document.getElementById("textoSelecao").value = `OlÃ¡, ${nome}! Passando para lembrar que ainda estou aguardando a seleÃ§Ã£o das fotos do ensaio do(a) ${filho}. ğŸ˜Š
Assim que estiver pronto(a), Ã© sÃ³ me enviar para darmos andamento Ã  ediÃ§Ã£o!`;

  document.getElementById("textoConfirmacao").value = `OlÃ¡, ${nome}! Tudo certo para o evento de aniversÃ¡rio do(a) ${filho}! ğŸ‰
Sua cobertura fotogrÃ¡fica estÃ¡ confirmada e serÃ¡ um prazer registrar esse momento especial com vocÃªs!
Nos vemos no dia combinado!`;
}

function copiarTexto(idTextarea) {
  const texto = document.getElementById(idTextarea).value;
  navigator.clipboard.writeText(texto)
    .then(() => alert("Texto copiado com sucesso!"))
    .catch(() => alert("Erro ao copiar o texto."));
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>
function copiarMensagemManual() {
  const campo = document.getElementById('campoTextoCopia');
  campo.select();
  document.execCommand('copy');
  alert("Texto copiado manualmente!");
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>// funÃ§Ã£o gerarTextoWhatsAppPorID substituÃ­da
function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script><script>
function gerarTextoWhatsAppPorID() {
  const idInput = document.getElementById('idAgendamentoTexto').value.trim();
  const id = parseInt(idInput);
  if (isNaN(id)) {
    alert("Digite um ID de agendamento vÃ¡lido.");
    return;
  }

  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const agendamento = agendamentos.find(a => a.id === id);

  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const cliente = clientes.find(c => c.id === agendamento.idCliente);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  const nome = cliente.nome;
  const dataObj = new Date(agendamento.data + "T00:00");
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
ğŸ“¸ Tipo de sessÃ£o: ${agendamento.tipo}
ğŸ“¦ Pacote: ${agendamento.pacote}
ğŸ“ Data: ${diaSemana}, ${dataFormatada}
ğŸ•’ HorÃ¡rio: ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° Reserva: R$${agendamento.reserva.toFixed(2)}
ğŸ’³ No dia: R$${agendamento.valorDia.toFixed(2)}
ğŸ Cashback gerado: R$${agendamento.cashback}
ğŸ’¼ Cashback acumulado: R$${cliente.cashback.toFixed(2)}

ğŸ“Œ Rodrigo Costa Fotografia
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9`;

  const textoWhatsApp = encodeURIComponent(mensagem);
  document.getElementById('mensagemWhatsTexto').value = mensagem;
const modal = new bootstrap.Modal(document.getElementById('mensagemWhatsModal'));
modal.show();
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<!-- Modal de Mensagem WhatsApp -->
<div aria-hidden="true" aria-labelledby="mensagemWhatsModalLabel" class="modal fade" id="mensagemWhatsModal" tabindex="-1">
<div class="modal-dialog modal-dialog-scrollable">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="mensagemWhatsModalLabel">ğŸ“© Mensagem para WhatsApp</h5>
<button aria-label="Fechar" class="btn-close" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body">
<textarea class="form-control" id="mensagemWhatsTexto" readonly="" rows="12"></textarea>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
<button class="btn btn-success" onclick="copiarTextoWhatsApp()">ğŸ“‹ Copiar Texto</button>
</div>
</div>
</div>
</div>
<!-- Modal WhatsApp -->
<div aria-hidden="true" aria-labelledby="modalWhatsAppLabel" class="modal fade" id="modalWhatsApp" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="modalWhatsAppLabel">Mensagem para WhatsApp</h5>
<button aria-label="Fechar" class="btn-close" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body">
<textarea class="form-control" id="mensagemWhatsTexto" readonly="" rows="12"></textarea>
</div>
<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
<button class="btn btn-success" onclick="copiarTextoWhatsApp()">ğŸ“‹ Copiar Mensagem</button>
</div>
</div>
</div>
</div>
<!-- Modal do WhatsApp -->
<div aria-hidden="true" aria-labelledby="modalWhatsAppLabel" class="modal fade" id="modalWhatsApp" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header bg-success text-white">
<h5 class="modal-title" id="modalWhatsAppLabel">ğŸ“© Mensagem para WhatsApp</h5>
<button aria-label="Fechar" class="btn-close btn-close-white" data-bs-dismiss="modal" type="button"></button>
</div>
<div class="modal-body">
<textarea class="form-control" id="mensagemWhatsTexto" readonly="" rows="14" style="font-family: monospace;"></textarea>
</div>
<div class="modal-footer">
<button class="btn btn-outline-primary" onclick="copiarTextoWhatsApp()">ğŸ“‹ Copiar texto</button>
<button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
</div>
</div>
</div>
</div>
<script>
function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}
</script>
<script>
function sugerirClientesPorNome(parteNome) {
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const datalist = document.getElementById("sugestoesClientes");
  datalist.innerHTML = "";
  clientes.forEach(cliente => {
    if (cliente.nome.toLowerCase().includes(parteNome.toLowerCase())) {
      const option = document.createElement("option");
      option.value = cliente.nome;
      datalist.appendChild(option);
    }
  });
}

function preencherClientePorNome(nome) {
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const cliente = clientes.find(c => c.nome.toLowerCase() === nome.toLowerCase());
  if (!cliente) return;
  document.getElementById('buscarIdCliente').value = cliente.id;
  document.getElementById('nomeCliente').value = cliente.nome;
  document.getElementById('instagramCliente').value = cliente.instagram;
  document.getElementById('filhoCliente').value = cliente.filho;
  document.getElementById('idadeCliente').value = cliente.idade;
  document.getElementById('postagemCliente').value = cliente.postagem;
  document.getElementById('cashbackCliente').value = `R$${(cliente.cashback || 0).toFixed(2)}`;
}

function editarCashbackCliente() {
  const id = document.getElementById("buscarIdCliente").value.trim();
  const novoValor = parseFloat(document.getElementById("novoValorCashback").value);
  if (!id || isNaN(novoValor)) {
    alert("Informe um ID de cliente vÃ¡lido e um novo valor de cashback.");
    return;
  }
  let clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  const index = clientes.findIndex(c => c.id == id);
  if (index === -1) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }
  clientes[index].cashback = novoValor;
  localStorage.setItem("clientes", JSON.stringify(clientes));
  document.getElementById("cashbackCliente").value = `R$${novoValor.toFixed(2)}`;
  alert("Cashback atualizado com sucesso!");
  listarClientes();
}
</script>
<script>
function listarClientes() {
  const lista = document.getElementById('listaClientes');
  if (!lista) return;

  lista.innerHTML = "";
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  if (clientes.length === 0) {
    lista.innerHTML = "<li class='list-group-item'>Nenhum cliente cadastrado.</li>";
    return;
  }

  clientes.forEach(c => {
    const item = document.createElement('li');
    item.className = "list-group-item";
    item.style.cursor = "pointer";
    item.onclick = function () {
      document.getElementById('nomeCliente').value = c.nome;
      document.getElementById('instagramCliente').value = c.instagram;
      document.getElementById('filhoCliente').value = c.filho;
      document.getElementById('idadeCliente').value = c.idade;
      document.getElementById('postagemCliente').value = c.postagem;
      document.getElementById('cashbackCliente').value = `R$${(c.cashback || 0).toFixed(2)}`;
    };

    item.innerHTML = `
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <strong>${c.nome}</strong> (${c.filho}, ${c.idade} anos)<br>
          ID: ${c.id} | Postagem: <strong>${c.postagem}</strong><br>ğŸ Cashback: R$${(c.cashback || 0).toFixed(2)}
        </div>
        <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); excluirCliente('${c.id}')">Excluir</button>
      </div>
    `;
    lista.appendChild(item);
  });
}
</script>
<script>
function ordenarClientesPorNome() {
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  clientes.sort((a, b) => a.nome.localeCompare(b.nome));
  localStorage.setItem("clientes", JSON.stringify(clientes));
  listarClientes();
}

function ordenarClientesPorID() {
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  clientes.sort((a, b) => parseInt(a.id) - parseInt(b.id));
  localStorage.setItem("clientes", JSON.stringify(clientes));
  listarClientes();
}
</script>
<script>
function buscarAgendamentosPorNome(nome) {
  nome = nome.trim().toLowerCase();
  const lista = document.getElementById("listaAgendamentos");
  lista.innerHTML = "";
  if (!nome) return;

  const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];
  const filtrados = agendamentos.filter(a => a.nome.toLowerCase().includes(nome));

  if (filtrados.length === 0) {
    lista.innerHTML = "<li class='list-group-item'>Nenhum agendamento encontrado para este nome.</li>";
    return;
  }

  filtrados.forEach(a => {
    const item = document.createElement("li");
    item.className = "list-group-item";
    item.innerHTML = `
      <strong>${a.nome}</strong> - ${a.data} Ã s ${a.hora} (${a.tipo})
      <br>Telefone: ${a.telefone || "nÃ£o informado"}
    `;
    lista.appendChild(item);
  });
}
</script>
<script>
function exibirAgendamentosFiltrados(nome) {
  nome = nome.trim().toLowerCase();
  const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];
  const area = document.getElementById("areaAgendamentos");
  if (!area) return;

  area.innerHTML = "";

  const filtrados = agendamentos.filter(a => a.nome && a.nome.toLowerCase().includes(nome));

  if (filtrados.length === 0) {
    area.innerHTML = "<p class='text-muted'>Nenhum agendamento encontrado com esse nome.</p>";
    return;
  }

  filtrados.forEach(a => {
    const div = document.createElement("div");
    div.className = "border rounded p-3 mb-3 bg-white shadow-sm";
    div.innerHTML = `
      <strong>ID ${a.id}</strong> - ğŸ“… ${a.data} - ${a.diaSemana} - ${a.hora}<br/>
      <strong>Tipo:</strong> ${a.tipo}<br/>
      ğŸ§  <strong>Tema:</strong> ${a.tema}<br/>
      ğŸ‘¤ <strong>Cliente:</strong> ${a.nome}<br/>
      ğŸ“¦ <strong>Pacote:</strong> ${a.pacote} fotos<br/>
      ğŸ’° <strong>Reserva:</strong> R$${a.valorReserva} | Restante: R$ ${a.valorRestante}
    `;
    area.appendChild(div);
  });
}
</script>
<script>
function buscarAgendamentosPorNome(nome) {
  nome = nome.trim().toLowerCase();
  const lista = document.getElementById("resultadosPorNome");
  lista.innerHTML = "";

  if (!nome) return;

  const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];
  const filtrados = agendamentos.filter(a => a.nome && a.nome.toLowerCase().includes(nome));

  if (filtrados.length === 0) {
    lista.innerHTML = "<li class='list-group-item'>Nenhum agendamento encontrado.</li>";
    return;
  }

  filtrados.forEach(a => {
    const item = document.createElement("li");
    item.className = "list-group-item";
    item.innerHTML = `
      <strong>ID ${a.id}</strong> - ğŸ“… ${a.data} - ${a.hora}<br/>
      <strong>Cliente:</strong> ${a.nome}<br/>
      <strong>Tipo:</strong> ${a.tipo} | <strong>Pacote:</strong> ${a.pacote} fotos
    `;
    lista.appendChild(item);
  });
}
</script>
<script>
function abrirAba(id, btn) {
    document.querySelectorAll('.section').forEach(div => div.style.display = 'none');
    document.getElementById(id).style.display = 'block';
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    btn.classList.add('active');
}

function salvarRenomearAba() {
    const de = document.getElementById('abaDe').value.trim();
    const para = document.getElementById('abaPara').value.trim();
    if (!de || !para) return alert("Preencha os dois campos.");
    let renomeacoes = JSON.parse(localStorage.getItem('renomeacoesAbas') || "{}");
    renomeacoes[de] = para;
    localStorage.setItem('renomeacoesAbas', JSON.stringify(renomeacoes));
    alert(`Aba "${de}" serÃ¡ exibida como "${para}"`);
}

function adicionarAba() {
    const nome = document.getElementById('novaAba').value;
    if (!nome) return alert("Informe um nome.");
    let abas = JSON.parse(localStorage.getItem('abasCriadas') || "[]");
    abas.push(nome);
    localStorage.setItem('abasCriadas', JSON.stringify(abas));
    alert("Aba adicionada!");
}

function salvarRenomearCampo() {
    const de = document.getElementById('campoDe').value.trim();
    const para = document.getElementById('campoPara').value.trim();
    if (!de || !para) return alert("Preencha os dois campos.");
    let renomeacoes = JSON.parse(localStorage.getItem('renomeacoesCampos') || "{}");
    renomeacoes[de] = para;
    localStorage.setItem('renomeacoesCampos', JSON.stringify(renomeacoes));
    alert(`Campo "${de}" serÃ¡ exibido como "${para}"`);
}

function adicionarCampo() {
    const nome = document.getElementById('novoCampo').value;
    const tipo = document.getElementById('classificacaoCampo').value;
    if (!nome) return alert("Informe um nome.");
    let campos = JSON.parse(localStorage.getItem('camposCriados') || "[]");
    campos.push({ nome, tipo });
    localStorage.setItem('camposCriados', JSON.stringify(campos));
    alert("Campo adicionado!");
}

// FÃ³rmula por linha
function adicionarLinha(tipo) {
    const campos = JSON.parse(localStorage.getItem('camposCriados') || "[]");
    const container = document.getElementById(tipo === 'receita' ? 'formulaReceitaContainer' : 'formulaDespesaContainer');

    const div = document.createElement('div');
    const selectCampo = document.createElement('select');
    campos.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c.nome;
        opt.textContent = c.nome;
        selectCampo.appendChild(opt);
    });

    const selectOperador = document.createElement('select');
    ['+', '-', '*', '/', '', '(', ')'].forEach(op => {
        const opt = document.createElement('option');
        opt.value = op;
        opt.textContent = op || '---';
        selectOperador.appendChild(opt);
    });

    div.appendChild(selectCampo);
    div.appendChild(selectOperador);
    container.appendChild(div);

    selectCampo.onchange = selectOperador.onchange = () => atualizarFormulaLinha(tipo);
}

function atualizarFormulaLinha(tipo) {
    const container = document.getElementById(tipo === 'receita' ? 'formulaReceitaContainer' : 'formulaDespesaContainer');
    const preview = document.getElementById(tipo === 'receita' ? 'previewLinhaReceita' : 'previewLinhaDespesa');
    const partes = [];

    container.querySelectorAll('div').forEach(div => {
        const campo = div.querySelector('select:nth-child(1)').value;
        const operador = div.querySelector('select:nth-child(2)').value;
        partes.push(campo);
        if (operador) partes.push(operador);
    });

    preview.textContent = partes.join(" ");
}

function salvarFormulaPorLinha(tipo) {
    const preview = document.getElementById(tipo === 'receita' ? 'previewLinhaReceita' : 'previewLinhaDespesa');
    localStorage.setItem(tipo === 'receita' ? 'formulaReceita' : 'formulaDespesa', preview.textContent.trim());
    alert("FÃ³rmula de " + tipo + " salva!");
}

function limparFormulaPorLinha(tipo) {
    const container = document.getElementById(tipo === 'receita' ? 'formulaReceitaContainer' : 'formulaDespesaContainer');
    const preview = document.getElementById(tipo === 'receita' ? 'previewLinhaReceita' : 'previewLinhaDespesa');
    container.innerHTML = '';
    preview.textContent = '';
}
window.onload = function () {
    atualizarFormulaLinha('receita');
    atualizarFormulaLinha('despesa');
};
</script>
<script>
function carregarAbasNoPainel() {
  const abas = ['Clientes', 'Agenda', 'Ãlbuns', 'Financeiro', 'Ferramentas', 'Cashback', 'Extra1'];
  const abaSelect = document.getElementById('abaDe');
  abaSelect.innerHTML = '<option value="">Selecione uma aba</option>';
  abas.forEach(aba => {
    const opt = document.createElement('option');
    opt.value = aba;
    opt.textContent = aba;
    abaSelect.appendChild(opt);
  });
}

function carregarCamposDaAba(aba) {
  const camposPorAba = {
    'Clientes': ['Nome do Cliente', 'Instagram', 'Nome do Filho(a)', 'Idade', 'Postagem Autorizada?'],
    'Agenda': ['Data', 'InÃ­cio', 'Fim', 'Tipo', 'Tema', 'Pacote', 'Valor do Pacote', 'Reserva', 'Valor no Dia'],
    'Ãlbuns': ['Tipo de Ãlbum', 'Fase do Ãlbum'],
    'Financeiro': ['Valor da Reserva', 'Valor no Dia', 'Cashback gerado'],
    'Ferramentas': [],
    'Cashback': ['Valor em Fotos Extras', 'Novo valor de cashback'],
    'Extra1': ['Lembrete', 'Agradecimento', 'Retirada Ãlbum', 'SeleÃ§Ã£o Atrasada', 'ConfirmaÃ§Ã£o']
  };

  const campoSelect = document.getElementById('campoDe');
  campoSelect.innerHTML = '<option value="">Selecione um campo</option>';
  (camposPorAba[aba] || []).forEach(campo => {
    const opt = document.createElement('option');
    opt.value = campo;
    opt.textContent = campo;
    campoSelect.appendChild(opt);
  });
}

document.addEventListener('DOMContentLoaded', carregarAbasNoPainel);
</script>
<script>
// ========== Armazenamento =========
function carregarAbasNoSelect() {
  const abas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  const abaDe = document.getElementById("abaDe");
  abaDe.innerHTML = "<option value=''>Selecione uma aba</option>";
  abas.forEach(nome => {
    const opt = document.createElement("option");
    opt.value = nome;
    opt.textContent = nome;
    abaDe.appendChild(opt);
  });
}

function carregarCamposDaAba(aba) {
  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  const campoSelect = document.getElementById("campoDe");
  campoSelect.innerHTML = "<option value=''>Selecione um campo</option>";
  if (campos[aba]) {
    campos[aba].forEach(c => {
      const opt = document.createElement("option");
      opt.value = c.nome;
      opt.textContent = c.nome;
      campoSelect.appendChild(opt);
    });
  }
}

function salvarRenomearAba() {
  const de = document.getElementById("abaDe").value;
  const para = document.getElementById("abaPara").value.trim();
  if (!de || !para) return alert("Preencha os dois campos.");

  let abas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  const index = abas.indexOf(de);
  if (index !== -1) {
    abas[index] = para;
    localStorage.setItem("abasPersonalizadas", JSON.stringify(abas));

    const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
    if (campos[de]) {
      campos[para] = campos[de];
      delete campos[de];
      localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
    }

    alert("Aba renomeada.");
    carregarAbasNoSelect();
  }
}

function adicionarAba() {
  const nova = document.getElementById("novaAba").value.trim();
  if (!nova) return alert("Digite o nome da nova aba.");
  let abas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  if (abas.includes(nova)) return alert("Essa aba jÃ¡ existe.");
  abas.push(nova);
  localStorage.setItem("abasPersonalizadas", JSON.stringify(abas));
  alert("Aba adicionada.");
  carregarAbasNoSelect();
}

function salvarRenomearCampo() {
  const aba = document.getElementById("abaDe").value;
  const de = document.getElementById("campoDe").value;
  const para = document.getElementById("campoPara").value.trim();
  if (!aba || !de || !para) return alert("Preencha todos os campos.");

  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  if (!campos[aba]) return;

  const index = campos[aba].findIndex(c => c.nome === de);
  if (index !== -1) {
    campos[aba][index].nome = para;
    localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
    alert("Campo renomeado.");
    carregarCamposDaAba(aba);
  }
}

function adicionarCampo() {
  const aba = document.getElementById("abaDe").value;
  const novo = document.getElementById("novoCampo").value.trim();
  const classificacao = document.getElementById("classificacaoCampo").value;
  if (!aba || !novo) return alert("Preencha os dados do campo.");

  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  if (!campos[aba]) campos[aba] = [];
  if (campos[aba].some(c => c.nome === novo)) return alert("Esse campo jÃ¡ existe.");

  campos[aba].push({ nome: novo, tipo: classificacao });
  localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
  alert("Campo adicionado.");
  carregarCamposDaAba(aba);
}

function excluirCampo() {
  const aba = document.getElementById("abaDe").value;
  const campo = document.getElementById("campoDe").value;
  if (!aba || !campo) return alert("Selecione a aba e o campo.");

  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  if (!campos[aba]) return;

  campos[aba] = campos[aba].filter(c => c.nome !== campo);
  localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
  alert("Campo excluÃ­do.");
  carregarCamposDaAba(aba);
}

window.addEventListener("load", () => {
  carregarAbasNoSelect();
});
</script>
<script>
// ========== InicializaÃ§Ã£o com abas padrÃ£o ==========
const abasPadrao = ["InÃ­cio", "Clientes", "Agenda", "Ãlbuns", "Financeiro", "Ferramentas", "Cashback"];

function inicializarAbasSeNecessario() {
  const salvas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  if (!salvas || salvas.length === 0) {
    localStorage.setItem("abasPersonalizadas", JSON.stringify(abasPadrao));
  }
}

// ========== Armazenamento =========
function carregarAbasNoSelect() {
  inicializarAbasSeNecessario();
  const abas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  const abaDe = document.getElementById("abaDe");
  abaDe.innerHTML = "<option value=''>Selecione uma aba</option>";
  abas.forEach(nome => {
    const opt = document.createElement("option");
    opt.value = nome;
    opt.textContent = nome;
    abaDe.appendChild(opt);
  });
}

function carregarCamposDaAba(aba) {
  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  const campoSelect = document.getElementById("campoDe");
  campoSelect.innerHTML = "<option value=''>Selecione um campo</option>";
  if (campos[aba]) {
    campos[aba].forEach(c => {
      const opt = document.createElement("option");
      opt.value = c.nome;
      opt.textContent = c.nome;
      campoSelect.appendChild(opt);
    });
  }
}

function salvarRenomearAba() {
  const de = document.getElementById("abaDe").value;
  const para = document.getElementById("abaPara").value.trim();
  if (!de || !para) return alert("Preencha os dois campos.");

  let abas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  const index = abas.indexOf(de);
  if (index !== -1) {
    abas[index] = para;
    localStorage.setItem("abasPersonalizadas", JSON.stringify(abas));

    const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
    if (campos[de]) {
      campos[para] = campos[de];
      delete campos[de];
      localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
    }

    alert("Aba renomeada.");
    carregarAbasNoSelect();
  }
}

function adicionarAba() {
  const nova = document.getElementById("novaAba").value.trim();
  if (!nova) return alert("Digite o nome da nova aba.");
  let abas = JSON.parse(localStorage.getItem("abasPersonalizadas") || "[]");
  if (abas.includes(nova)) return alert("Essa aba jÃ¡ existe.");
  abas.push(nova);
  localStorage.setItem("abasPersonalizadas", JSON.stringify(abas));
  alert("Aba adicionada.");
  carregarAbasNoSelect();
}

function salvarRenomearCampo() {
  const aba = document.getElementById("abaDe").value;
  const de = document.getElementById("campoDe").value;
  const para = document.getElementById("campoPara").value.trim();
  if (!aba || !de || !para) return alert("Preencha todos os campos.");

  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  if (!campos[aba]) return;

  const index = campos[aba].findIndex(c => c.nome === de);
  if (index !== -1) {
    campos[aba][index].nome = para;
    localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
    alert("Campo renomeado.");
    carregarCamposDaAba(aba);
  }
}

function adicionarCampo() {
  const aba = document.getElementById("abaDe").value;
  const novo = document.getElementById("novoCampo").value.trim();
  const classificacao = document.getElementById("classificacaoCampo").value;
  if (!aba || !novo) return alert("Preencha os dados do campo.");

  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  if (!campos[aba]) campos[aba] = [];
  if (campos[aba].some(c => c.nome === novo)) return alert("Esse campo jÃ¡ existe.");

  campos[aba].push({ nome: novo, tipo: classificacao });
  localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
  alert("Campo adicionado.");
  carregarCamposDaAba(aba);
}

function excluirCampo() {
  const aba = document.getElementById("abaDe").value;
  const campo = document.getElementById("campoDe").value;
  if (!aba || !campo) return alert("Selecione a aba e o campo.");

  const campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "{}");
  if (!campos[aba]) return;

  campos[aba] = campos[aba].filter(c => c.nome !== campo);
  localStorage.setItem("camposPersonalizados", JSON.stringify(campos));
  alert("Campo excluÃ­do.");
  carregarCamposDaAba(aba);
}

window.addEventListener("load", () => {
  carregarAbasNoSelect();
});
</script>
<script>
// ================= FUNÃ‡Ã•ES DE PERSONALIZAÃ‡ÃƒO =================

function salvarRenomearAba() {
  const de = document.getElementById('abaDe').value;
  const para = document.getElementById('abaPara').value;
  if (!de || !para) return alert('Selecione uma aba e digite o novo nome.');
  let abas = JSON.parse(localStorage.getItem('abasPersonalizadas') || '{}');
  abas[de] = para;
  localStorage.setItem('abasPersonalizadas', JSON.stringify(abas));
  alert('RenomeaÃ§Ã£o salva!');
  carregarAbasPersonalizadas();
}

function adicionarAba() {
  const nome = document.getElementById('novaAba').value.trim();
  if (!nome) return alert('Digite o nome da nova aba.');
  let abas = JSON.parse(localStorage.getItem('abasPersonalizadas') || '{}');
  const id = 'aba_' + Date.now();
  abas[id] = nome;
  localStorage.setItem('abasPersonalizadas', JSON.stringify(abas));
  alert('Aba adicionada!');
  document.getElementById('novaAba').value = '';
  carregarAbasPersonalizadas();
}

function salvarRenomearCampo() {
  const aba = document.getElementById('abaDe').value;
  const de = document.getElementById('campoDe').value;
  const para = document.getElementById('campoPara').value;
  if (!de || !para || !aba) return alert('Selecione a aba e os campos.');
  let campos = JSON.parse(localStorage.getItem('camposPersonalizados') || '{}');
  if (!campos[aba]) campos[aba] = {};
  campos[aba][de] = campos[aba][de] || {};
  campos[aba][de].nome = para;
  localStorage.setItem('camposPersonalizados', JSON.stringify(campos));
  alert('Campo renomeado!');
  carregarCamposDaAba(aba);
}

function adicionarCampo() {
  const aba = document.getElementById('abaDe').value;
  const nome = document.getElementById('novoCampo').value.trim();
  const tipo = document.getElementById('classificacaoCampo').value;
  if (!aba || !nome) return alert('Selecione a aba e digite o nome do campo.');
  let campos = JSON.parse(localStorage.getItem('camposPersonalizados') || '{}');
  if (!campos[aba]) campos[aba] = {};
  const id = 'campo_' + Date.now();
  campos[aba][id] = { nome, tipo };
  localStorage.setItem('camposPersonalizados', JSON.stringify(campos));
  alert('Campo adicionado!');
  document.getElementById('novoCampo').value = '';
  carregarCamposDaAba(aba);
}

function carregarAbasPersonalizadas() {
  const select = document.getElementById('abaDe');
  select.innerHTML = '<option value="">Selecione uma aba</option>';
  const abas = JSON.parse(localStorage.getItem('abasPersonalizadas') || '{}');
  for (const id in abas) {
    const opt = document.createElement('option');
    opt.value = id;
    opt.textContent = abas[id];
    select.appendChild(opt);
  }
}

function carregarCamposDaAba(abaId) {
  const campos = JSON.parse(localStorage.getItem('camposPersonalizados') || '{}');
  const select = document.getElementById('campoDe');
  select.innerHTML = '<option value="">Selecione um campo</option>';
  if (campos[abaId]) {
    for (const campoId in campos[abaId]) {
      const nome = campos[abaId][campoId].nome;
      const opt = document.createElement('option');
      opt.value = campoId;
      opt.textContent = nome;
      select.appendChild(opt);
    }
  }
}

function adicionarLinha(tipo) {
  const container = document.getElementById('formula' + capitalize(tipo) + 'Container');
  const campos = obterCamposClassificados(tipo);
  const select = document.createElement('select');
  select.innerHTML = campos.map(c => `<option value="${c}">${c}</option>`).join('');
  container.appendChild(select);
  atualizarPreviewFormula(tipo);
  select.addEventListener('change', () => atualizarPreviewFormula(tipo));
}

function atualizarPreviewFormula(tipo) {
  const container = document.getElementById('formula' + capitalize(tipo) + 'Container');
  const spans = Array.from(container.querySelectorAll('select')).map(sel => sel.value);
  document.getElementById('previewLinha' + capitalize(tipo)).textContent = spans.join(' + ');
}

function salvarFormulaPorLinha(tipo) {
  const container = document.getElementById('formula' + capitalize(tipo) + 'Container');
  const campos = Array.from(container.querySelectorAll('select')).map(sel => sel.value);
  localStorage.setItem('formulaLinha_' + tipo, JSON.stringify(campos));
  alert('FÃ³rmula salva!');
}

function limparFormulaPorLinha(tipo) {
  localStorage.removeItem('formulaLinha_' + tipo);
  document.getElementById('formula' + capitalize(tipo) + 'Container').innerHTML = '';
  document.getElementById('previewLinha' + capitalize(tipo)).textContent = '';
}

function obterCamposClassificados(tipo) {
  const campos = JSON.parse(localStorage.getItem('camposPersonalizados') || '{}');
  let lista = [];
  for (const abaId in campos) {
    for (const campoId in campos[abaId]) {
      if (campos[abaId][campoId].tipo === tipo) {
        lista.push(campos[abaId][campoId].nome);
      }
    }
  }
  return lista;
}

function carregarFormulasSalvas() {
  ['receita', 'despesa'].forEach(tipo => {
    const campos = JSON.parse(localStorage.getItem('formulaLinha_' + tipo) || '[]');
    const container = document.getElementById('formula' + capitalize(tipo) + 'Container');
    campos.forEach(campo => {
      const select = document.createElement('select');
      const opcoes = obterCamposClassificados(tipo);
      select.innerHTML = opcoes.map(c => `<option value="${c}" ${c === campo ? 'selected' : ''}>${c}</option>`).join('');
      select.addEventListener('change', () => atualizarPreviewFormula(tipo));
      container.appendChild(select);
    });
    atualizarPreviewFormula(tipo);
  });
}

function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

window.addEventListener('load', () => {
  carregarAbasPersonalizadas();
  carregarFormulasSalvas();
  document.getElementById('abaDe').addEventListener('change', e => carregarCamposDaAba(e.target.value));
});
</script>
<script>
function excluirCampo() {
  const campoSelecionado = document.getElementById("campoDe").value;

  if (!campoSelecionado) {
    alert("Selecione um campo para excluir.");
    return;
  }

  if (!confirm(`Tem certeza que deseja excluir o campo "${campoSelecionado}"?`)) {
    return;
  }

  let campos = JSON.parse(localStorage.getItem("camposPersonalizados") || "[]");
  campos = campos.filter(c => c.nome !== campoSelecionado);
  localStorage.setItem("camposPersonalizados", JSON.stringify(campos));

  alert(`Campo "${campoSelecionado}" excluÃ­do com sucesso!`);

  if (typeof carregarCampos === 'function') carregarCampos();
  else location.reload();
}
</script>
<script>
function excluirAba() {
  const select = document.getElementById('abaDe');
  const abaSelecionada = select.value;

  if (!abaSelecionada) {
    alert("Selecione uma aba para excluir.");
    return;
  }

  // Verifica se Ã© uma aba padrÃ£o do sistema (essas nÃ£o devem ser excluÃ­das)
  const abasPadrao = ["InÃ­cio", "Clientes", "Agenda", "Ãlbuns", "Financeiro", "Ferramentas", "Cashback", "Mensagens"];
  if (abasPadrao.includes(abaSelecionada)) {
    alert(`A aba "${abaSelecionada}" faz parte do sistema e nÃ£o pode ser excluÃ­da.`);
    return;
  }

  if (!confirm(`Deseja realmente excluir a aba "${abaSelecionada}" e seus campos associados?`)) {
    return;
  }

  // Remove do localStorage
  let abas = JSON.parse(localStorage.getItem('abasPersonalizadas')) || [];
  abas = abas.filter(aba => aba !== abaSelecionada);
  localStorage.setItem('abasPersonalizadas', JSON.stringify(abas));

  // Remove campos da aba
  let campos = JSON.parse(localStorage.getItem('camposPersonalizados')) || {};
  if (campos[abaSelecionada]) {
    delete campos[abaSelecionada];
    localStorage.setItem('camposPersonalizados', JSON.stringify(campos));
  }

  // Atualiza selects e campos
  carregarAbasSalvas();
  carregarCamposDaAba("");
  document.getElementById("campoDe").innerHTML = '<option value="">Selecione um campo</option>';

  alert(`Aba "${abaSelecionada}" excluÃ­da com sucesso!`);
}
</script>

<script>
window.addEventListener('DOMContentLoaded', () => {
  aplicarAbasPersonalizadas();
  aplicarCamposPersonalizados();
});

function aplicarAbasPersonalizadas() {
  const abas = JSON.parse(localStorage.getItem('abasCriadas') || '[]');
  const renomeacoes = JSON.parse(localStorage.getItem('renomeacoesAbas') || '{}');
  const navs = document.querySelectorAll('nav');

  abas.forEach(nome => {
    const id = 'tela-' + nome.toLowerCase().replace(/\s+/g, '-');
    const nomeExibido = renomeacoes[nome] || nome;
    const jaExiste = document.querySelector(`a[data-id="${id}"]`);
    if (!jaExiste) {
      const a = document.createElement('a');
      a.href = '#';
      a.className = 'navbtn';
      a.setAttribute('data-id', id);
      a.onclick = function () { mostrarTela(id, a); };
      a.innerHTML = `<i class="fas fa-folder"></i><br>${nomeExibido}`;
      navs[0].appendChild(a);
    }
  });
}

function aplicarCamposPersonalizados() {
  const campos = JSON.parse(localStorage.getItem('camposCriados') || '[]');
  const renomeacoes = JSON.parse(localStorage.getItem('renomeacoesCampos') || '{}');
  campos.forEach(nome => {
    const nomeExibido = renomeacoes[nome] || nome;
    const tela = document.getElementById('tela-clientes');
    if (tela && !document.getElementById('campo-' + nome)) {
      const div = document.createElement('div');
      div.className = 'mb-3';
      div.innerHTML = `<label class="form-label">${nomeExibido}</label><input id="campo-${nome}" class="form-control" type="text"/>`;
      tela.appendChild(div);
    }
  });
}

function excluirAba() {
  const select = document.getElementById('abaDe');
  const nome = select.value;
  if (!nome) return alert("Selecione uma aba.");
  let abas = JSON.parse(localStorage.getItem('abasCriadas') || '[]');
  abas = abas.filter(a => a !== nome);
  localStorage.setItem('abasCriadas', JSON.stringify(abas));
  alert("Aba excluÃ­da.");
  location.reload();
}

function excluirCampo() {
  const select = document.getElementById('campoDe');
  const nome = select.value;
  if (!nome) return alert("Selecione um campo.");
  let campos = JSON.parse(localStorage.getItem('camposCriados') || '[]');
  campos = campos.filter(c => c !== nome);
  localStorage.setItem('camposCriados', JSON.stringify(campos));
  alert("Campo excluÃ­do.");
  location.reload();
}
</script>
</body>
</html>
<script>
function salvarAlbum() {
  const idCliente = document.getElementById('idClienteAlbum').value.trim();
  const fase = document.getElementById('faseAlbum').value;
  const tipo = document.getElementById('tipoAlbum').value;

  if (!idCliente || !fase) {
    alert("Preencha todos os campos.");
    return;
  }

  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];
  const cliente = clientes.find(c => c.id === idCliente);

  if (!cliente) {
    alert("Cliente nÃ£o encontrado.");
    return;
  }

  let albuns = JSON.parse(localStorage.getItem('albuns')) || [];
  const existente = albuns.find(a => a.idCliente === idCliente);

  if (existente) {
    existente.fase = fase;
    existente.tipo = tipo;
  } else {
    albuns.push({ idCliente, nome: cliente.nome, fase, tipo });
  }

  localStorage.setItem('albuns', JSON.stringify(albuns));
  listarAlbuns();
  alert("Fase do Ã¡lbum atualizada com sucesso!");
  document.getElementById('idClienteAlbum').value = "";
  document.getElementById('faseAlbum').value = "SeleÃ§Ã£o enviada";
}

function listarAlbuns() {
  const lista = document.getElementById('listaAlbuns');
  lista.innerHTML = "";

  const albuns = JSON.parse(localStorage.getItem('albuns')) || [];
  if (albuns.length === 0) {
    lista.innerHTML = "<li class='list-group-item'>Nenhum Ã¡lbum registrado.</li>";
    return;
  }

  albuns.forEach(a => {
    const item = document.createElement('li');
    item.className = "list-group-item d-flex justify-content-between align-items-center";
    item.innerHTML = `
      <div>
        <strong>${a.nome}</strong> (ID: ${a.idCliente})<br/>
        Tipo: <span class="badge bg-primary me-2">${a.tipo}</span> Fase: <span class="badge bg-info">${a.fase}</span>
      </div>
      <button class="btn btn-sm btn-outline-danger" onclick="excluirAlbum('${a.idCliente}')">Excluir</button>
    `;
    lista.appendChild(item);
  });
}

function excluirAlbum(idCliente) {
  let albuns = JSON.parse(localStorage.getItem('albuns')) || [];
  albuns = albuns.filter(a => a.idCliente !== idCliente);
  localStorage.setItem('albuns', JSON.stringify(albuns));
  listarAlbuns();
  alert("Ãlbum removido com sucesso!");
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function importarClientes(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const novosClientes = JSON.parse(e.target.result);
      if (!Array.isArray(novosClientes)) {
        alert("Formato invÃ¡lido. Deve ser uma lista de clientes.");
        return;
      }

      let clientes = JSON.parse(localStorage.getItem('clientes')) || [];
      novosClientes.forEach(novo => {
        if (!novo.nome || !novo.id) return; // validaÃ§Ã£o bÃ¡sica
        if (!clientes.some(c => c.id === novo.id)) {
          clientes.push(novo);
        }
      });

      localStorage.setItem('clientes', JSON.stringify(clientes));
      listarClientes();
      alert("Clientes importados com sucesso!");
    } catch (err) {
      alert("Erro ao importar arquivo: " + err.message);
    }
  };
  reader.readAsText(file);
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>

function destacarBotaoRelatorio(botao) {
  document.querySelectorAll("#tela-financeiro .btn, #tela-ferramentas .btn").forEach(b => b.classList.remove("active"));
  botao.classList.add("active");
}


function importarClientePorTexto() {
  const texto = document.getElementById("campoTextoImportacao").value.trim();
  if (!texto) {
    alert("Cole o texto do cliente.");
    return;
  }

  const regex = /Nome:\s*(.+?)\n|Instagram:\s*(.+?)\n|Filho\(a\):\s*(.+?)\n|Idade:\s*(\d+)|Postagem:\s*(Sim|NÃ£o)/gi;
  let nome = "", instagram = "", filho = "", idade = "", postagem = "Sim";

  const linhas = texto.split(/\n|\r/).map(l => l.trim());
  linhas.forEach(linha => {
    if (linha.toLowerCase().includes("nome:")) nome = linha.split(":")[1]?.trim() || "";
    if (linha.toLowerCase().includes("instagram:")) instagram = linha.split(":")[1]?.trim() || "";
    if (linha.toLowerCase().includes("filho")) filho = linha.split(":")[1]?.trim() || "";
    if (linha.toLowerCase().includes("idade:")) idade = linha.split(":")[1]?.trim() || "";
    if (linha.toLowerCase().includes("postagem")) postagem = linha.split(":")[1]?.trim() || "Sim";
  });

  if (!nome) {
    alert("NÃ£o foi possÃ­vel extrair o nome. Verifique o texto.");
    return;
  }

  const id = Date.now().toString();
  const novo = { id, nome, instagram, filho, idade, postagem, cashback: 0 };

  let clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  clientes.push(novo);
  localStorage.setItem("clientes", JSON.stringify(clientes));
  listarClientes();
  alert("Cliente importado com sucesso!");
  document.getElementById("campoTextoImportacao").value = "";
}

function gerarTextoWhatsAppPorID() {
  const id = document.getElementById('idAgendamentoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = `OlÃ¡, ${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* ${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* ${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* ${agendamento.pacote}
ğŸ“ *Data:* ${diaSemana}, ${dataFormatada}
ğŸ•’ *HorÃ¡rio:* ${agendamento.hora} Ã s ${agendamento.fim}

ğŸ’° *Valor da reserva:* R$${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia* 
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa`;

  document.getElementById('mensagemWhatsTexto').value = mensagem;

  
}

function copiarTextoWhatsApp() {
  const texto = document.getElementById('mensagemWhatsTexto').value;
  navigator.clipboard.writeText(texto).catch(() => {
    console.error("Erro ao copiar o texto.");
  });
}

</script>
<script>
function gerarMensagemConfirmacaoAgendamento() {
  const id = document.getElementById('idConfirmacaoTexto').value.trim();
  const agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
  const clientes = JSON.parse(localStorage.getItem('clientes')) || [];

  const agendamento = agendamentos.find(a => a.id.toString() === id);
  if (!agendamento) {
    alert("Agendamento nÃ£o encontrado.");
    return;
  }

  const cliente = clientes.find(c => c.id === agendamento.idCliente);
  const nome = cliente ? cliente.nome : "Cliente";
  const cashbackAcumulado = cliente ? (cliente.cashback || 0).toFixed(2) : "0.00";

  const dataObj = new Date(agendamento.data + 'T00:00');
  const diaSemana = dataObj.toLocaleDateString('pt-BR', { weekday: 'long' });
  const dataFormatada = dataObj.toLocaleDateString('pt-BR');

  const mensagem = \`OlÃ¡, \${nome}! Tudo bem? ğŸ˜Š

Seu agendamento estÃ¡ confirmado com sucesso!
Aqui estÃ£o os detalhes da sua sessÃ£o:

ğŸ†” *ID do cliente:* \${agendamento.idCliente}
ğŸ“¸ *Tipo de sessÃ£o:* \${agendamento.tipo}
ğŸ“¦ *Pacote escolhido:* \${agendamento.pacote}
ğŸ“ *Data:* \${diaSemana}, \${dataFormatada}
ğŸ•’ *HorÃ¡rio:* \${agendamento.hora} Ã s \${agendamento.fim}

ğŸ’° *Valor da reserva:* R$\${agendamento.reserva.toFixed(2)}
ğŸ’³ *Valor a pagar no dia:* R$\${agendamento.valorDia.toFixed(2)}
ğŸ *Cashback gerado:* R$\${agendamento.cashback.toFixed(2)}
ğŸ’¼ *Cashback acumulado:* R$\${cashbackAcumulado}

âœ… *Regras de uso CashBack:*
_Ele pode ser usado como desconto no valor final de um ensaio ou sessÃ£o futura, seja para vocÃª ou atÃ© para ajudar no pagamento de uma sessÃ£o de alguÃ©m especial._
- Pode ser usado apenas para abater o valor final de uma nova sessÃ£o.
- NÃ£o Ã© vÃ¡lido para fotos extras nem para pagamento da reserva.
âš ï¸ _Importante: seu cashback Ã© vÃ¡lido atÃ© 31/12/2025. ApÃ³s essa data, ele serÃ¡ expirado._

ğŸ“Œ *Local: Rodrigo Costa Fotografia*  
ğŸ“ https://maps.app.goo.gl/Za3PmMixjS11RgUr9

*Qualquer dÃºvida, Ã© sÃ³ me chamar!*  
âœ¨ _Vai ser um prazer registrar esse momento especial com vocÃªs!_

_Atenciosamente,_  
Rodrigo Costa\`;

  document.getElementById("textoConfirmacaoAgendamento").value = mensagem;
}
</script>
<script>
function toggleAgendamentos() {
  const lista = document.getElementById("listaProximosAgendamentos");
  const botao = document.getElementById("botaoToggleAgendamentos");

  if (lista.style.display === "none") {
    lista.style.display = "block";
    botao.innerHTML = "ğŸ‘ï¸ Ocultar Agendamentos";
  } else {
    lista.style.display = "none";
    botao.innerHTML = "ğŸ‘ï¸ Mostrar Agendamentos";
  }
}
</script>
<script>
function ordenarClientesPorNome() {
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  clientes.sort((a, b) => a.nome.localeCompare(b.nome));
  localStorage.setItem("clientes", JSON.stringify(clientes));
  listarClientes();
}

function ordenarClientesPorID() {
  const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
  clientes.sort((a, b) => a.id - b.id);
  localStorage.setItem("clientes", JSON.stringify(clientes));
  listarClientes();
}

function excluirAba() {
  const abaSelecionada = document.getElementById('abaDe').value;
  if (!abaSelecionada) {
    alert("Selecione uma aba para excluir.");
    return;
  }

  if (!confirm(`Tem certeza que deseja excluir a aba "${abaSelecionada}"? Esta aÃ§Ã£o nÃ£o poderÃ¡ ser desfeita.`)) {
    return;
  }

  let abas = JSON.parse(localStorage.getItem('abasPersonalizadas')) || [];
  abas = abas.filter(aba => aba !== abaSelecionada);
  localStorage.setItem('abasPersonalizadas', JSON.stringify(abas));

  // Remove os campos vinculados a essa aba
  let campos = JSON.parse(localStorage.getItem('camposPersonalizados')) || [];
  campos = campos.filter(c => c.aba !== abaSelecionada);
  localStorage.setItem('camposPersonalizados', JSON.stringify(campos));

  alert(`Aba "${abaSelecionada}" excluÃ­da com sucesso!`);
  location.reload();
}

</script>
